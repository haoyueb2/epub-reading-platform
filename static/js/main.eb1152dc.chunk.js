(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{397:function(e,t,a){e.exports=a(804)},401:function(e,t,a){},486:function(e,t,a){},495:function(e,t,a){},496:function(e,t,a){},505:function(e,t,a){},539:function(e,t,a){},688:function(e,t,a){},723:function(e,t,a){},728:function(e,t,a){},804:function(e,t,a){"use strict";a.r(t);var n,o=a(0),r=a.n(o),l=a(11),i=a.n(l),s=(a(401),a(8)),c=a(10),u=a(14),d=a(12),p=a(13),h=a(44),m=a(125),g=a(55),b=(a(405),a(253)),f=a(39),v=a(57),y=b.b.Item,k=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).phoneClick=function(){var e=Object(l.findDOMNode)(a.menu),t=!a.state.phoneOpen;a.setState({phoneOpen:t,menuHeight:t?e.scrollHeight:0})},a.state={phoneOpen:!1,menuHeight:0},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=Object(g.a)({},this.props),a=t.dataSource,n=t.isMobile;delete t.dataSource,delete t.isMobile;var o=this.state,l=o.menuHeight,i=o.phoneOpen,s=a.Menu.children,c=Object.keys(s).map(function(e,t){return r.a.createElement(y,Object.assign({key:t.toString()},s[e]),r.a.createElement(v.b,Object.assign({},s[e].a,{to:s[e].a.href,target:s[e].a.target}),s[e].a.children))});return r.a.createElement(f.b,Object.assign({component:"header",animation:{opacity:0,type:"from"}},a.wrapper,t),r.a.createElement("div",Object.assign({},a.page,{className:"".concat(a.page.className).concat(i?" open":"")}),r.a.createElement(f.b,Object.assign({animation:{x:-30,type:"from",ease:"easeOutQuad"}},a.logo)),n&&r.a.createElement("div",Object.assign({},a.mobileMenu,{onClick:function(){e.phoneClick()}}),r.a.createElement("em",null),r.a.createElement("em",null),r.a.createElement("em",null)),r.a.createElement(f.b,Object.assign({},a.Menu,{animation:{x:30,type:"from",ease:"easeOutQuad"},ref:function(t){e.menu=t},style:n?{height:l}:null}),r.a.createElement(b.b,{mode:n?"inline":"horizontal",defaultSelectedKeys:["0"],theme:n?"dark":"default"},c))))}}]),t}(r.a.Component),E=a(71),O=a.n(E),C=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=Object(g.a)({},this.props),t=e.dataSource;return delete e.dataSource,delete e.isMobile,r.a.createElement("div",Object.assign({},e,t.wrapper),r.a.createElement(O.a,t.OverPack,r.a.createElement(f.b,Object.assign({animation:{y:"+=30",opacity:0,type:"from"},key:"footer"},t.copyright),t.copyright.children)))}}]),t}(r.a.PureComponent),j=(a(132),a(16)),S=(a(114),a(45)),N=a(124),x=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=Object(g.a)({},this.props),t=e.dataSource;return delete e.dataSource,delete e.isMobile,r.a.createElement("div",Object.assign({},e,t.wrapper),r.a.createElement(N.a,Object.assign({key:"QueueAnim",type:["bottom","top"],delay:200},t.textWrapper),r.a.createElement("div",Object.assign({key:"title"},t.title),t.title.children.match(/\.(svg|gif|jpg|jpeg|png|JPG|PNG|GIF|JPEG)$/)?r.a.createElement("img",{src:t.title.children,width:"100%",alt:"img"}):t.title.children),r.a.createElement("div",Object.assign({key:"content"},t.content),t.content.children),r.a.createElement(S.a,Object.assign({ghost:!0,key:"button"},t.button),t.button.children)),r.a.createElement(f.b,{animation:{y:"-=20",yoyo:!0,repeat:-1,duration:1e3},className:"banner0-icon",key:"icon"},r.a.createElement(j.a,{type:"down"})))}}]),t}(r.a.PureComponent),w=(a(204),a(121)),B=a(91),T=(a(205),a(104)),P=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).getBlockChildren=function(e){return e.map(function(e,t){var a=e.children;return r.a.createElement(T.a,Object.assign({key:t.toString()},e),r.a.createElement("div",a.icon,r.a.createElement("img",{src:a.icon.children,width:"100%",alt:"img"})),r.a.createElement("h3",a.title,a.title.children),r.a.createElement("p",a.content,a.content.children))})},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=Object(g.a)({},this.props),t=e.dataSource;delete e.dataSource,delete e.isMobile;var a=this.getBlockChildren(t.block.children);return r.a.createElement("div",Object.assign({},e,t.wrapper),r.a.createElement("div",t.page,r.a.createElement("div",t.titleWrapper,t.titleWrapper.children.map(function(e,t){return r.a.createElement(0===e.name.indexOf("title")?"h1":"div",Object(B.a)({key:t.toString()},e),e.children.match(/\.(svg|gif|jpg|jpeg|png|JPG|PNG|GIF|JPEG)$/)?r.a.createElement("img",{src:e.children,height:"100%",alt:"img"}):e.children)})),r.a.createElement(O.a,t.OverPack,r.a.createElement(N.a,Object.assign({type:"bottom",key:"block",leaveReverse:!0},t.block,{component:w.a}),a))))}}]),t}(r.a.PureComponent),M=(a(480),a(252)),I=M.a.TabPane,F=(r.a.Component,function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=Object(g.a)({},this.props),t=e.dataSource;return delete e.dataSource,delete e.isMobile,r.a.createElement(O.a,Object.assign({},e,t.OverPack),r.a.createElement(N.a,Object.assign({type:"bottom",leaveReverse:!0,key:"page",delay:[0,100]},t.titleWrapper),t.titleWrapper.children.map(function(e,t){return r.a.createElement(0===e.name.indexOf("title")?"h1":"div",Object(B.a)({key:t.toString()},e),e.children.match(/\.(svg|gif|jpg|jpeg|png|JPG|PNG|GIF|JPEG)$/)?r.a.createElement("img",{src:e.children,alt:"img"}):e.children)})))}}]),t}(r.a.PureComponent)),R=(r.a.PureComponent,{wrapper:{className:"header0 home-page-wrapper"},page:{className:"home-page"},logo:{className:"header0-logo",children:"\u7396\u8bfb\u5e73\u53f0"},Menu:{className:"header0-menu",children:[{name:"item0",a:{children:"\u9996\u9875",href:"/"}},{name:"item1",a:{children:"\u4e66\u57ce",href:"/page2"}},{name:"item2",a:{children:"\u4e66\u67b6",href:"/page3"}},{name:"item3",a:{children:"\u767b\u5f55",href:"/session"}}]},mobileMenu:{className:"header0-mobile-menu"}}),D={wrapper:{className:"banner0"},textWrapper:{className:"banner0-text-wrapper"},title:{className:"banner0-title",children:"logo.svg"},content:{className:"banner0-content",children:r.a.createElement("span",null,r.a.createElement("p",null,"\u7396\u8bfb"),r.a.createElement("p",null,"epub\u7535\u5b50\u4e66\u9605\u8bfb\u5e73\u53f0"))},button:{className:"banner0-button",children:"Learn More"}},A={wrapper:{className:"home-page-wrapper content0-wrapper"},page:{className:"home-page content0"},OverPack:{playScale:.3,className:""},titleWrapper:{className:"title-wrapper",children:[{name:"title",children:"\u7efc\u5408\u9605\u8bfb\u4f53\u9a8c"}]},block:{className:"block-wrapper",children:[{name:"block0",className:"block",md:8,xs:24,children:{icon:{className:"icon",children:"https://zos.alipayobjects.com/rmsportal/WBnVOjtIlGWbzyQivuyq.png"},title:{children:"\u4e66\u57ce\u6d4f\u89c8"},content:{children:"\u6bcf\u672c\u4e66\u90fd\u6709\u52a8\u753b\u573a\u666f"}}},{name:"block1",className:"block",md:8,xs:24,children:{icon:{className:"icon",children:"https://zos.alipayobjects.com/rmsportal/YPMsLQuCEXtuEkmXTTdk.png"},title:{children:"\u52a0\u5165\u4e66\u67b6"},content:{children:"\u7528\u6237\u770b\u5230\u611f\u5174\u8da3\u7684\u4e66\u5728\u767b\u5f55\u540e\u53ef\u4ee5\u52a0\u5165\u4e66\u67b6"}}},{name:"block2",className:"block",md:8,xs:24,children:{icon:{className:"icon",children:"https://zos.alipayobjects.com/rmsportal/EkXWVvAaFJKCzhMmQYiX.png"},title:{children:"\u652f\u6301epub"},content:{children:"\u5728\u6bcf\u65e5\u7684\u9605\u8bfb\u4e2d\u79ef\u7d2f\u77e5\u8bc6"}}}]}},z=(r.a.createElement("span",null,r.a.createElement("h3",null,"\u6280\u672f"),r.a.createElement("p",null,"\u4e30\u5bcc\u7684\u6280\u672f\u7ec4\u4ef6\uff0c\u7b80\u5355\u7ec4\u88c5\u5373\u53ef\u5feb\u901f\u642d\u5efa\u91d1\u878d\u7ea7\u5e94\u7528\uff0c\u4e30\u5bcc\u7684\u6280\u672f\u7ec4\u4ef6\uff0c\u7b80\u5355\u7ec4\u88c5\u5373\u53ef\u5feb\u901f\u642d\u5efa\u91d1\u878d\u7ea7\u5e94\u7528\u3002"),r.a.createElement("br",null),r.a.createElement("h3",null,"\u878d\u5408"),r.a.createElement("p",null,"\u89e3\u653e\u4e1a\u52a1\u53ca\u6280\u672f\u751f\u4ea7\u529b\uff0c\u63a8\u52a8\u91d1\u878d\u670d\u52a1\u5e95\u5c42\u521b\u65b0\uff0c\u63a8\u52a8\u91d1\u878d\u670d\u52a1\u5e95\u5c42\u521b\u65b0\u3002\u89e3\u653e\u4e1a\u52a1\u53ca\u6280\u672f\u751f\u4ea7\u529b\uff0c\u63a8\u52a8\u91d1\u878d\u670d\u52a1\u5e95\u5c42\u521b\u65b0\u3002"),r.a.createElement("br",null),r.a.createElement("h3",null,"\u5f00\u653e"),"\u7b26\u5408\u91d1\u878d\u53ca\u8981\u6c42\u7684\u5b89\u5168\u53ef\u9760\u3001\u9ad8\u53ef\u7528\u3001\u9ad8\u6027\u80fd\u7684\u670d\u52a1\u80fd\u529b\uff0c\u7b26\u5408\u91d1\u878d\u53ca\u8981\u6c42\u7684\u5b89\u5168\u53ef\u9760\u3001\u9ad8\u53ef\u7528\u3001\u9ad8\u6027\u80fd\u7684\u670d\u52a1\u80fd\u529b\u3002"),r.a.createElement("span",null,r.a.createElement("h3",null,"\u6280\u672f"),r.a.createElement("p",null,"\u4e30\u5bcc\u7684\u6280\u672f\u7ec4\u4ef6\uff0c\u7b80\u5355\u7ec4\u88c5\u5373\u53ef\u5feb\u901f\u642d\u5efa\u91d1\u878d\u7ea7\u5e94\u7528\uff0c\u4e30\u5bcc\u7684\u6280\u672f\u7ec4\u4ef6\uff0c\u7b80\u5355\u7ec4\u88c5\u5373\u53ef\u5feb\u901f\u642d\u5efa\u91d1\u878d\u7ea7\u5e94\u7528\u3002"),r.a.createElement("br",null),r.a.createElement("h3",null,"\u878d\u5408"),r.a.createElement("p",null,"\u89e3\u653e\u4e1a\u52a1\u53ca\u6280\u672f\u751f\u4ea7\u529b\uff0c\u63a8\u52a8\u91d1\u878d\u670d\u52a1\u5e95\u5c42\u521b\u65b0\uff0c\u63a8\u52a8\u91d1\u878d\u670d\u52a1\u5e95\u5c42\u521b\u65b0\u3002\u89e3\u653e\u4e1a\u52a1\u53ca\u6280\u672f\u751f\u4ea7\u529b\uff0c\u63a8\u52a8\u91d1\u878d\u670d\u52a1\u5e95\u5c42\u521b\u65b0\u3002"),r.a.createElement("br",null),r.a.createElement("h3",null,"\u5f00\u653e"),"\u7b26\u5408\u91d1\u878d\u53ca\u8981\u6c42\u7684\u5b89\u5168\u53ef\u9760\u3001\u9ad8\u53ef\u7528\u3001\u9ad8\u6027\u80fd\u7684\u670d\u52a1\u80fd\u529b\uff0c\u7b26\u5408\u91d1\u878d\u53ca\u8981\u6c42\u7684\u5b89\u5168\u53ef\u9760\u3001\u9ad8\u53ef\u7528\u3001\u9ad8\u6027\u80fd\u7684\u670d\u52a1\u80fd\u529b\u3002"),r.a.createElement("span",null,r.a.createElement("h3",null,"\u6280\u672f"),r.a.createElement("p",null,"\u4e30\u5bcc\u7684\u6280\u672f\u7ec4\u4ef6\uff0c\u7b80\u5355\u7ec4\u88c5\u5373\u53ef\u5feb\u901f\u642d\u5efa\u91d1\u878d\u7ea7\u5e94\u7528\uff0c\u4e30\u5bcc\u7684\u6280\u672f\u7ec4\u4ef6\uff0c\u7b80\u5355\u7ec4\u88c5\u5373\u53ef\u5feb\u901f\u642d\u5efa\u91d1\u878d\u7ea7\u5e94\u7528\u3002"),r.a.createElement("br",null),r.a.createElement("h3",null,"\u878d\u5408"),r.a.createElement("p",null,"\u89e3\u653e\u4e1a\u52a1\u53ca\u6280\u672f\u751f\u4ea7\u529b\uff0c\u63a8\u52a8\u91d1\u878d\u670d\u52a1\u5e95\u5c42\u521b\u65b0\uff0c\u63a8\u52a8\u91d1\u878d\u670d\u52a1\u5e95\u5c42\u521b\u65b0\u3002\u89e3\u653e\u4e1a\u52a1\u53ca\u6280\u672f\u751f\u4ea7\u529b\uff0c\u63a8\u52a8\u91d1\u878d\u670d\u52a1\u5e95\u5c42\u521b\u65b0\u3002"),r.a.createElement("br",null),r.a.createElement("h3",null,"\u5f00\u653e"),"\u7b26\u5408\u91d1\u878d\u53ca\u8981\u6c42\u7684\u5b89\u5168\u53ef\u9760\u3001\u9ad8\u53ef\u7528\u3001\u9ad8\u6027\u80fd\u7684\u670d\u52a1\u80fd\u529b\uff0c\u7b26\u5408\u91d1\u878d\u53ca\u8981\u6c42\u7684\u5b89\u5168\u53ef\u9760\u3001\u9ad8\u53ef\u7528\u3001\u9ad8\u6027\u80fd\u7684\u670d\u52a1\u80fd\u529b\u3002"),{OverPack:{className:"home-page-wrapper content13-wrapper home-page-wrapper content13-wrapper jnwq7vhwgqg-editor_css",playScale:.3},titleWrapper:{className:"title-wrapper",children:[{name:"title",children:"\u5f00\u59cb\u4f60\u7684\u9605\u8bfb\u4e4b\u65c5\u5427",className:"title-h1"},{name:"content",children:"\u5728\u4e66\u57ce\u67e5\u627e\u4f60\u611f\u5174\u8da3\u7684\u4e66\uff0c\u611f\u53d7svg\u52a8\u753b\u4f53\u9a8c",className:"title-content"},{name:"content2",children:"\u767b\u5f55\u540e\u5373\u53ef\u52a0\u5165\u4e66\u67b6\u5f00\u59cb\u9605\u8bfb",className:"title-content"}]}}),q={wrapper:{className:"home-page-wrapper footer0-wrapper"},OverPack:{className:"home-page footer0",playScale:.05},copyright:{className:"copyright",children:r.a.createElement("span",null,"\xa92019 \u540c\u6d4e\u5927\u5b66\u8f6f\u4ef6\u5b66\u9662web\u8bfe\u7a0b\u9879\u76ee made by \u767d\u7693\u6708")}};a(486);Object(m.enquireScreen)(function(e){n=e});var H=window.location,_=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={isMobile:n,show:!H.port},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(m.enquireScreen)(function(t){e.setState({isMobile:!!t})}),H.port&&setTimeout(function(){e.setState({show:!0})},500)}},{key:"render",value:function(){var e=this,t=[r.a.createElement(x,{id:"Banner0_0",key:"Banner0_0",dataSource:D,isMobile:this.state.isMobile}),r.a.createElement(P,{id:"Content0_0",key:"Content0_0",dataSource:A,isMobile:this.state.isMobile}),r.a.createElement(F,{id:"Content13_0",key:"Content13_0",dataSource:z,isMobile:this.state.isMobile})];return r.a.createElement("div",{className:"templates-wrapper",ref:function(t){e.dom=t}},this.state.show&&t)}}]),t}(r.a.Component),L=(a(806),a(185)),J=(a(492),a(394)),U=a(4),W=a(72),Y=(a(495),function(e){return{type:"RECEIVE_ERRORS",errors:e}}),X=function(e){return{type:"RECEIVE_CURRENT_USER",currentUser:e}},G=function(e){var t=e.type,a=e.text;return r.a.createElement("span",null,r.a.createElement(j.a,{type:t,style:{marginRight:8}}),a)},V=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={data:[]},a.delete_bookshelf=a.delete_bookshelf.bind(Object(U.a)(a)),a.fetchBookshelf=a.fetchBookshelf(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){var e=this;null!=this.props.currentUser&&fetch(window.webBase+"api/bookshelf/"+this.props.currentUser.id).then(function(e){return e.json()}).then(function(t){var a=[];if(null!=e.props.books){var n=!0,o=!1,r=void 0;try{for(var l,i=t[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var s=l.value;a.push(e.props.books[s.book_id])}}catch(c){o=!0,r=c}finally{try{n||null==i.return||i.return()}finally{if(o)throw r}}}e.setState({data:a})})}},{key:"fetchBookshelf",value:function(){}},{key:"delete_bookshelf",value:function(e){var t=this,a={user_id:this.props.currentUser.id,book_id:e};fetch(window.webBase+"api/delete_bookshelf",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(a)}).then(function(e){fetch(window.webBase+"api/bookshelf/"+t.props.currentUser.id).then(function(e){return e.json()}).then(function(e){var a=[];if(null!=t.props.books){var n=!0,o=!1,r=void 0;try{for(var l,i=e[Symbol.iterator]();!(n=(l=i.next()).done);n=!0){var s=l.value;a.push(t.props.books[s.book_id])}}catch(c){o=!0,r=c}finally{try{n||null==i.return||i.return()}finally{if(o)throw r}}}t.setState({data:a})})})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"templates-wrapper",ref:function(t){e.dom=t}},r.a.createElement("div",{style:{background:"#fff",padding:24,minHeight:280}},r.a.createElement("h1",null,"\u6211\u7684\u4e66\u67b6"),r.a.createElement(L.a,{className:"list",itemLayout:"vertical",size:"large",dataSource:this.state.data,footer:r.a.createElement("div",null," ",r.a.createElement("b",null,"\u6211\u7684")," \u4e66\u67b6"),renderItem:function(t){return r.a.createElement(L.a.Item,{key:t.title,actions:[r.a.createElement(J.a,{disabled:!0,defaultValue:parseFloat(t.rating),allowHalf:!0,tooltips:[t.rating,t.rating,t.rating,t.rating,t.rating]}),r.a.createElement(G,{type:"edit",text:t.rating+"\u5206"}),r.a.createElement(G,{type:"user",text:t.author}),r.a.createElement(v.b,{to:"/page2/reader/"+t.title},r.a.createElement(S.a,null,"\u5f00\u59cb\u9605\u8bfb")),r.a.createElement(S.a,{onClick:e.delete_bookshelf.bind(e,t.id)},"\u79fb\u51fa\u4e66\u67b6")],extra:r.a.createElement("img",{width:100,alt:"logo",src:t.cover_image_url})},r.a.createElement(L.a.Item.Meta,{title:t.title,description:t.description}))}})))}}]),t}(r.a.Component),K=Object(h.d)(Object(W.b)(function(e,t){return{books:e.books,currentUser:e.session.currentUser}},function(e){return{}})(V)),Q=function(e){function t(e){return Object(s.a)(this,t),Object(u.a)(this,Object(d.a)(t).call(this,e))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){if(this.props.books){var e=this.props.books.map(function(e,t){var a=e.book_id||e.id;return r.a.createElement("div",{className:"div-book",key:t},r.a.createElement(v.b,{to:"/page2/".concat(a)},r.a.createElement("img",{className:"front-image",src:e.cover_image_url,alt:e.title})))});return r.a.createElement("div",{className:"index-main"},r.a.createElement("div",{className:"book-index-div"},r.a.createElement("div",{className:"book-index-lower-div"},e)))}return r.a.createElement("h1",null,"None")}}]),t}(r.a.Component),$=Object(h.d)(Q),Z=(a(496),function(e){function t(e){return Object(s.a)(this,t),Object(u.a)(this,Object(d.a)(t).call(this,e))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.requestBookIndex()}},{key:"render",value:function(){return r.a.createElement($,{books:this.props.books})}}]),t}(r.a.Component)),ee=Object(h.d)(Z),te=a(105),ae=Object(h.d)(Object(W.b)(function(e){return{books:(t=e.books,Object(te.values)(t))};var t},function(e){return{requestBookIndex:function(){return e(function(e){return fetch(window.webBase+"api/books").then(function(t){return t.json().then(function(t){e({type:"RECEIVE_BOOKS",book:t})})},function(e){console.log("error")})})}}})(ee)),ne=(a(497),a(395)),oe=(a(499),a(82)),re=(a(206),a(47)),le=(a(207),a(56)),ie=a(255),se=a(19),ce=a(109),ue=a(393),de=function(e){this.manager=void 0!==e?e:se.DefaultLoadingManager};de.prototype={constructor:de,load:function(e,t,a,n){var o=this,r=new se.FileLoader(o.manager);r.setPath(o.path),r.load(e,function(e){t(o.parse(e))},a,n)},setPath:function(e){return this.path=e,this},parse:function(e){function t(e,t,n,o,r,l,i,s){o=o*Math.PI/180,t=Math.abs(t),n=Math.abs(n);var c=(i.x-s.x)/2,u=(i.y-s.y)/2,d=Math.cos(o)*c+Math.sin(o)*u,p=-Math.sin(o)*c+Math.cos(o)*u,h=t*t,m=n*n,g=d*d,b=p*p,f=g/h+b/m;if(f>1){var v=Math.sqrt(f);h=(t*=v)*t,m=(n*=v)*n}var y=h*b+m*g,k=(h*m-y)/y,E=Math.sqrt(Math.max(0,k));r===l&&(E=-E);var O=E*t*p/n,C=-E*n*d/t,j=Math.cos(o)*O-Math.sin(o)*C+(i.x+s.x)/2,S=Math.sin(o)*O+Math.cos(o)*C+(i.y+s.y)/2,N=a(1,0,(d-O)/t,(p-C)/n),x=a((d-O)/t,(p-C)/n,(-d-O)/t,(-p-C)/n)%(2*Math.PI);e.currentPath.absellipse(j,S,t,n,N,N+x,0===l,o)}function a(e,t,a,n){var o=e*a+t*n,r=Math.sqrt(e*e+t*t)*Math.sqrt(a*a+n*n),l=Math.acos(Math.max(-1,Math.min(1,o/r)));return e*n-t*a<0&&(l=-l),l}function n(e,t){return t=Object.assign({},t),e.hasAttribute("fill")&&(t.fill=e.getAttribute("fill")),""!==e.style.fill&&(t.fill=e.style.fill),t}function o(e){return"none"!==e.fill&&"transparent"!==e.fill}function r(e,t){return e-(t-e)}function l(e){for(var t=e.split(/[\s,]+|(?=\s?[+\-])/),a=0;a<t.length;a++){var n=t[a];if(n.indexOf(".")!==n.lastIndexOf("."))for(var o=n.split("."),r=2;r<o.length;r++)t.splice(a+r-1,0,"0."+o[r]);t[a]=parseFloat(n)}return t}function i(e){var t=e.elements;return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function s(e){var t=e.elements;return Math.sqrt(t[3]*t[3]+t[4]*t[4])}var c=[],u=[],d=new se.Matrix3,p=new se.Matrix3,h=new se.Matrix3,m=new se.Matrix3,g=new se.Matrix3;return function e(a,b){if(1===a.nodeType){var f=function(e){if(!e.hasAttribute("transform"))return null;var t=function(e){for(var t=new se.Matrix3,a=d,n=e.getAttribute("transform").split(" "),o=n.length-1;o>=0;o--){var r=n[o],i=r.indexOf("("),s=r.indexOf(")");if(i>0&&i<s){var c=r.substr(0,i),u=l(r.substr(i+1,s-i-1));switch(a.identity(),c){case"translate":if(u.length>=1){var g=u[0],b=g;u.length>=2&&(b=u[1]),a.translate(g,b)}break;case"rotate":if(u.length>=1){var f=0,v=0,y=0;f=-u[0]*Math.PI/180,u.length>=3&&(v=u[1],y=u[2]),p.identity().translate(-v,-y),h.identity().rotate(f),m.multiplyMatrices(h,p),p.identity().translate(v,y),a.multiplyMatrices(p,m)}break;case"scale":if(u.length>=1){var k=u[0],E=k;u.length>=2&&(E=u[1]),a.scale(k,E)}break;case"skewX":1===u.length&&a.set(1,Math.tan(u[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":1===u.length&&a.set(1,0,0,Math.tan(u[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":6===u.length&&a.set(u[0],u[2],u[4],u[1],u[3],u[5],0,0,1)}}t.premultiply(a)}return t}(e);return t&&(u.length>0&&t.premultiply(u[u.length-1]),g.copy(t),u.push(t)),t}(a),v=null;switch(a.nodeName){case"svg":break;case"g":b=n(a,b);break;case"path":b=n(a,b),a.hasAttribute("d")&&o(b)&&(v=function(e,a){var n=new se.ShapePath;n.color.setStyle(a.fill);for(var o=new se.Vector2,i=new se.Vector2,s=new se.Vector2,c=!0,u=!1,d=e.getAttribute("d").match(/[a-df-z][^a-df-z]*/gi),p=0,h=d.length;p<h;p++){var m=d[p],g=m.charAt(0),b=m.substr(1).trim();switch(!0===c&&(u=!0,c=!1),g){case"M":for(var f=l(b),v=0,y=f.length;v<y;v+=2)o.x=f[v+0],o.y=f[v+1],i.x=o.x,i.y=o.y,0===v?n.moveTo(o.x,o.y):n.lineTo(o.x,o.y),0===v&&!0===u&&s.copy(o);break;case"H":for(var f=l(b),v=0,y=f.length;v<y;v++)o.x=f[v],i.x=o.x,i.y=o.y,n.lineTo(o.x,o.y),0===v&&!0===u&&s.copy(o);break;case"V":for(var f=l(b),v=0,y=f.length;v<y;v++)o.y=f[v],i.x=o.x,i.y=o.y,n.lineTo(o.x,o.y),0===v&&!0===u&&s.copy(o);break;case"L":for(var f=l(b),v=0,y=f.length;v<y;v+=2)o.x=f[v+0],o.y=f[v+1],i.x=o.x,i.y=o.y,n.lineTo(o.x,o.y),0===v&&!0===u&&s.copy(o);break;case"C":for(var f=l(b),v=0,y=f.length;v<y;v+=6)n.bezierCurveTo(f[v+0],f[v+1],f[v+2],f[v+3],f[v+4],f[v+5]),i.x=f[v+2],i.y=f[v+3],o.x=f[v+4],o.y=f[v+5],0===v&&!0===u&&s.copy(o);break;case"S":for(var f=l(b),v=0,y=f.length;v<y;v+=4)n.bezierCurveTo(r(o.x,i.x),r(o.y,i.y),f[v+0],f[v+1],f[v+2],f[v+3]),i.x=f[v+0],i.y=f[v+1],o.x=f[v+2],o.y=f[v+3],0===v&&!0===u&&s.copy(o);break;case"Q":for(var f=l(b),v=0,y=f.length;v<y;v+=4)n.quadraticCurveTo(f[v+0],f[v+1],f[v+2],f[v+3]),i.x=f[v+0],i.y=f[v+1],o.x=f[v+2],o.y=f[v+3],0===v&&!0===u&&s.copy(o);break;case"T":for(var f=l(b),v=0,y=f.length;v<y;v+=2){var k=r(o.x,i.x),E=r(o.y,i.y);n.quadraticCurveTo(k,E,f[v+0],f[v+1]),i.x=k,i.y=E,o.x=f[v+0],o.y=f[v+1],0===v&&!0===u&&s.copy(o)}break;case"A":for(var f=l(b),v=0,y=f.length;v<y;v+=7){var O=o.clone();o.x=f[v+5],o.y=f[v+6],i.x=o.x,i.y=o.y,t(n,f[v],f[v+1],f[v+2],f[v+3],f[v+4],O,o),0===v&&!0===u&&s.copy(o)}break;case"m":for(var f=l(b),v=0,y=f.length;v<y;v+=2)o.x+=f[v+0],o.y+=f[v+1],i.x=o.x,i.y=o.y,0===v?n.moveTo(o.x,o.y):n.lineTo(o.x,o.y),0===v&&!0===u&&s.copy(o);break;case"h":for(var f=l(b),v=0,y=f.length;v<y;v++)o.x+=f[v],i.x=o.x,i.y=o.y,n.lineTo(o.x,o.y),0===v&&!0===u&&s.copy(o);break;case"v":for(var f=l(b),v=0,y=f.length;v<y;v++)o.y+=f[v],i.x=o.x,i.y=o.y,n.lineTo(o.x,o.y),0===v&&!0===u&&s.copy(o);break;case"l":for(var f=l(b),v=0,y=f.length;v<y;v+=2)o.x+=f[v+0],o.y+=f[v+1],i.x=o.x,i.y=o.y,n.lineTo(o.x,o.y),0===v&&!0===u&&s.copy(o);break;case"c":for(var f=l(b),v=0,y=f.length;v<y;v+=6)n.bezierCurveTo(o.x+f[v+0],o.y+f[v+1],o.x+f[v+2],o.y+f[v+3],o.x+f[v+4],o.y+f[v+5]),i.x=o.x+f[v+2],i.y=o.y+f[v+3],o.x+=f[v+4],o.y+=f[v+5],0===v&&!0===u&&s.copy(o);break;case"s":for(var f=l(b),v=0,y=f.length;v<y;v+=4)n.bezierCurveTo(r(o.x,i.x),r(o.y,i.y),o.x+f[v+0],o.y+f[v+1],o.x+f[v+2],o.y+f[v+3]),i.x=o.x+f[v+0],i.y=o.y+f[v+1],o.x+=f[v+2],o.y+=f[v+3],0===v&&!0===u&&s.copy(o);break;case"q":for(var f=l(b),v=0,y=f.length;v<y;v+=4)n.quadraticCurveTo(o.x+f[v+0],o.y+f[v+1],o.x+f[v+2],o.y+f[v+3]),i.x=o.x+f[v+0],i.y=o.y+f[v+1],o.x+=f[v+2],o.y+=f[v+3],0===v&&!0===u&&s.copy(o);break;case"t":for(var f=l(b),v=0,y=f.length;v<y;v+=2){var k=r(o.x,i.x),E=r(o.y,i.y);n.quadraticCurveTo(k,E,o.x+f[v+0],o.y+f[v+1]),i.x=k,i.y=E,o.x=o.x+f[v+0],o.y=o.y+f[v+1],0===v&&!0===u&&s.copy(o)}break;case"a":for(var f=l(b),v=0,y=f.length;v<y;v+=7){var O=o.clone();o.x+=f[v+5],o.y+=f[v+6],i.x=o.x,i.y=o.y,t(n,f[v],f[v+1],f[v+2],f[v+3],f[v+4],O,o),0===v&&!0===u&&s.copy(o)}break;case"Z":case"z":n.currentPath.autoClose=!0,n.currentPath.curves.length>0&&(o.copy(s),n.currentPath.currentPoint.copy(o),c=!0)}u=!1}return n}(a,b));break;case"rect":o(b=n(a,b))&&(v=function(e,t){var a=parseFloat(e.getAttribute("x")||0),n=parseFloat(e.getAttribute("y")||0),o=parseFloat(e.getAttribute("rx")||0),r=parseFloat(e.getAttribute("ry")||0),l=parseFloat(e.getAttribute("width")),i=parseFloat(e.getAttribute("height")),s=new se.ShapePath;return s.color.setStyle(t.fill),s.moveTo(a+2*o,n),s.lineTo(a+l-2*o,n),(0!==o||0!==r)&&s.bezierCurveTo(a+l,n,a+l,n,a+l,n+2*r),s.lineTo(a+l,n+i-2*r),(0!==o||0!==r)&&s.bezierCurveTo(a+l,n+i,a+l,n+i,a+l-2*o,n+i),s.lineTo(a+2*o,n+i),(0!==o||0!==r)&&s.bezierCurveTo(a,n+i,a,n+i,a,n+i-2*r),s.lineTo(a,n+2*r),(0!==o||0!==r)&&s.bezierCurveTo(a,n,a,n,a+2*o,n),s}(a,b));break;case"polygon":o(b=n(a,b))&&(v=function(e,t){var a=new se.ShapePath;a.color.setStyle(t.fill);var n=0;return e.getAttribute("points").replace(/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,function(e,t,o){var r=parseFloat(t),l=parseFloat(o);0===n?a.moveTo(r,l):a.lineTo(r,l),n++}),a.currentPath.autoClose=!0,a}(a,b));break;case"polyline":o(b=n(a,b))&&(v=function(e,t){var a=new se.ShapePath;a.color.setStyle(t.fill);var n=0;return e.getAttribute("points").replace(/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,function(e,t,o){var r=parseFloat(t),l=parseFloat(o);0===n?a.moveTo(r,l):a.lineTo(r,l),n++}),a.currentPath.autoClose=!1,a}(a,b));break;case"circle":o(b=n(a,b))&&(v=function(e,t){var a=parseFloat(e.getAttribute("cx")),n=parseFloat(e.getAttribute("cy")),o=parseFloat(e.getAttribute("r")),r=new se.Path;r.absarc(a,n,o,0,2*Math.PI);var l=new se.ShapePath;return l.color.setStyle(t.fill),l.subPaths.push(r),l}(a,b));break;case"ellipse":o(b=n(a,b))&&(v=function(e,t){var a=parseFloat(e.getAttribute("cx")),n=parseFloat(e.getAttribute("cy")),o=parseFloat(e.getAttribute("rx")),r=parseFloat(e.getAttribute("ry")),l=new se.Path;l.absellipse(a,n,o,r,0,2*Math.PI);var i=new se.ShapePath;return i.color.setStyle(t.fill),i.subPaths.push(l),i}(a,b));break;case"line":o(b=n(a,b))&&(v=function(e,t){var a=parseFloat(e.getAttribute("x1")),n=parseFloat(e.getAttribute("y1")),o=parseFloat(e.getAttribute("x2")),r=parseFloat(e.getAttribute("y2")),l=new se.ShapePath;return l.moveTo(a,n),l.lineTo(o,r),l.currentPath.autoClose=!1,l}(a))}v&&(function(e,t){function a(e){o.set(e.x,e.y,1).applyMatrix3(t),e.set(o.x,o.y)}!function(e){0!==e.elements[1]||e.elements[3]}(t);for(var n=new se.Vector2,o=new se.Vector3,r=e.subPaths,l=0,c=r.length;l<c;l++)for(var u=r[l],d=u.curves,p=0;p<d.length;p++){var h=d[p];h.isLineCurve?(a(h.v1),a(h.v2)):h.isCubicBezierCurve?(a(h.v0),a(h.v1),a(h.v2),a(h.v3)):h.isQuadraticBezierCurve?(a(h.v0),a(h.v1),a(h.v2)):h.isEllipseCurve&&(n.set(h.aX,h.aY),a(n),h.aX=n.x,h.aY=n.y,h.xRadius*=i(t),h.yRadius*=s(t))}}(v,g),c.push(v));for(var y=a.childNodes,k=0;k<y.length;k++)e(y[k],b);f&&g.copy(u.pop())}}((new DOMParser).parseFromString(e,"image/svg+xml").documentElement,{fill:"#000"}),c}};var pe=a(148);function he(e){console.log(e.book.id);var t=Object(o.useState)([]),a=Object(ie.a)(t,2),n=a[0],l=a[1],i=Object(o.useState)(!0),s=Object(ie.a)(i,2),c=s[0],u=s[1];Object(o.useEffect)(function(){setInterval(function(){return u(function(e){return!e})},3e3)},[]),Object(o.useEffect)(function(){var t;c?(t=e.book.title,new Promise(function(e){return(new de).load(window.webBase+"api/svg/"+t,function(t){return e(Object(ue.a)(t.map(function(e,t){return e.toShapes(!0).map(function(a){return{shape:a,color:e.color,index:t}})})))})})).then(l):l([])},[c]);var d=Object(pe.b)(n,function(e){return e.shape.uuid},{from:{position:[-50,0,0],rotation:[0,-.6,0],opacity:0},enter:{position:[0,0,0],rotation:[0,.3,0],opacity:1},leave:{position:[50,0,0],rotation:[0,.6,0],opacity:0},order:["leave","enter","update"],lazy:!0,trail:5,unique:!0,reset:!0}),p=se.Math.degToRad;return r.a.createElement(pe.a.group,{position:[500,-400,0],rotation:[0,p(180),0]},d.map(function(e){var t=e.item,a=t.shape,n=t.color,o=(t.index,e.key),l=e.props,i=l.opacity,s=l.position,c=l.rotation;return r.a.createElement(pe.a.mesh,{key:o,rotation:c,position:s.interpolate(function(e,t,a){return[e,t,0]})},r.a.createElement(pe.a.meshPhongMaterial,{attach:"material",color:n,opacity:i,side:se.DoubleSide,depthWrite:!1,transparent:!0}),r.a.createElement("shapeBufferGeometry",{attach:"geometry",args:[a]}))}))}var me=function(e){function t(e){return Object(s.a)(this,t),Object(u.a)(this,Object(d.a)(t).call(this,e))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"main"},r.a.createElement(ce.a,{camera:{fov:90,position:[0,0,500],rotation:[0,0,se.Math.degToRad(180)],near:.1,far:2e4}},r.a.createElement("ambientLight",{intensity:.5}),r.a.createElement("spotLight",{intensity:.5,position:[300,300,4e3]}),r.a.createElement(he,{book:this.props.book})),r.a.createElement("span",{className:"middle"},r.a.createElement("div",null,this.props.book.title)))}}]),t}(r.a.Component),ge=(a(505),le.a.TextArea,function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e){a.setState({value:e.target.value})},a.handleSubmit=function(){a.state.value&&(a.setState({submitting:!0}),setTimeout(function(){a.setState({submitting:!1,value:""})},1e3))},a.state={bookID:a.props.match.params.id,submitting:!1,value:""},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"addToShelf",value:function(){if(null===this.props.currentUser)console.log("\u65e0\u7528\u6237");else{var e={user_id:this.props.currentUser.id,book_id:this.props.book.id};fetch(window.webBase+"api/bookshelf",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then(function(e){return e.text()}).then(function(e){return console.log(e)})}}},{key:"render",value:function(){var e=this,t=(this.props.match.params.id,this.state);t.submitting,t.value;if(this.props.book){var a=this.props.book;return r.a.createElement("div",null,r.a.createElement(me,{book:this.props.book}),r.a.createElement("div",{className:"book-show"},r.a.createElement(S.a,{type:"primary",size:"large",onClick:function(t){return e.addToShelf()}},"\u52a0\u5165\u4e66\u67b6"),r.a.createElement(v.b,{to:"/page2/reader/"+this.props.book.title},r.a.createElement(S.a,null,"\u5f00\u59cb\u9605\u8bfb")),r.a.createElement(oe.a,{title:"\u4e66\u7c4d\u4fe1\u606f",bordered:!0},r.a.createElement(oe.a.Item,{label:"\u6807\u9898"},a.title),r.a.createElement(oe.a.Item,{label:"\u4f5c\u8005"},a.author),r.a.createElement(oe.a.Item,{label:"\u9875\u6570"},a.pages),r.a.createElement(oe.a.Item,{label:"\u51fa\u7248\u793e"},a.publisher),r.a.createElement(oe.a.Item,{label:"\u8bc4\u5206",span:1},a.rating),r.a.createElement(oe.a.Item,{label:"\u72b6\u6001",span:3},r.a.createElement(ne.a,{status:"processing",text:"\u6709epub\u8d44\u6e90"})),r.a.createElement(oe.a.Item,{label:"\u7b80\u4ecb"},a.description,r.a.createElement("br",null)))))}return null}}]),t}(r.a.Component)),be=Object(h.d)(ge),fe=Object(h.d)(Object(W.b)(function(e,t){return{book:e.books[t.match.params.id],currentUser:e.session.currentUser}},function(e){return{}})(be)),ve=a(50),ye=a(32),ke=a(122),Ee=a.n(ke),Oe=a(81),Ce=a.n(Oe),je=a(362),Se=a.n(je),Ne=a(38),xe=a.n(Ne),we=(a(539),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={open:!0,help:!1},a.chapterList=null,a.handleClose=a.handleClose.bind(Object(U.a)(a)),a.handleOpen=a.handleOpen.bind(Object(U.a)(a)),a.handleHelp=a.handleHelp.bind(Object(U.a)(a)),a.myRef=Object(o.createRef)(),a.toc=null,a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.epub.getToc().then(function(t){e.chapterList=e.getChapters(t,!1),e.bindEventForChapters()})}},{key:"componentWillUpdate",value:function(){var e=this.myRef.current;null!=e&&(this.toc=e),null!=this.toc&&null!=this.chapterList&&this.toc.appendChild(this.chapterList),!1===this.state.help&&this.setState({help:!0})}},{key:"getChapters",value:function(e,t){var a=this,n=document.createElement("ul");return n.className=t?"chapter-list collapse":"chapter-list expand",e.forEach(function(e){var t,o=document.createElement("li");o.className="chapter-list-item",t='<div class="item-content">\n                <i class="item-mark"></i>\n                <a class="chapter-url" href="'.concat(e.href,'">').concat(e.label,"</a>\n             </div>"),o.innerHTML=t,n.appendChild(o),e.subitems&&e.subitems.length&&o.appendChild(a.getChapters(e.subitems,!0))}),n}},{key:"bindEventForChapters",value:function(){var e=this;this.chapterList.addEventListener("click",function(t){var a=t.target;if("a"===a.nodeName.toLowerCase()){var n=a.getAttribute("href");e.props.epub.goto(n),console.log("navigation render: ",e.props.epub.isRendered),t.preventDefault()}})}},{key:"handleOpen",value:function(){this.setState({open:!0})}},{key:"handleClose",value:function(){this.setState({open:!1})}},{key:"handleHelp",value:function(){this.setState({help:!1}),console.log("\u6267\u884c\uff0chelp\u503c:"+this.state.help)}},{key:"render",value:function(){var e=this.props,t=e.theme,a=e.classes,n={color:t?"#000000de":"#fff"};return r.a.createElement("div",{id:"navigation"},r.a.createElement(Ce.a,{onClick:this.handleOpen,className:a.button},r.a.createElement(Se.a,null)),r.a.createElement(Ee.a,{open:this.state.open,onClose:this.handleHelp,onClick:this.handleClose},r.a.createElement("div",{className:a.title},r.a.createElement(xe.a,{type:"title",align:"center"},"Table Of Contents")),r.a.createElement("div",{ref:this.myRef,className:a.list,style:n})))}}]),t}(r.a.Component)),Be=Object(ye.withStyles)({button:{position:"relative",left:0,top:0,zIndex:10},list:{width:280,flex:"initial"},title:{marginTop:15,marginBottom:15}})(we),Te=a(363),Pe=a.n(Te),Me=a(364),Ie=a.n(Me),Fe=a(46),Re=a(180),De=a.n(Re),Ae=function e(t,a,n,o,r,l,i){Object(s.a)(this,e),this.key=(new Date).getTime()+"",this.bookKey=t,this.chapter=a,this.text=n,this.cfi=o,this.range=r,this.color=l,this.note=i||""},ze=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).createNote=a.createNote.bind(Object(U.a)(a)),a.closeMenu=a.closeMenu.bind(Object(U.a)(a)),a.handleHighlight=a.handleHighlight.bind(Object(U.a)(a)),a.handleCopyPlainText=a.handleCopyPlainText.bind(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"createNote",value:function(e){var t=this.props,a=(t.book,t.epub),n=document.getElementsByTagName("iframe")[0],o=n.contentDocument,r=o.getSelection(),l=r.getRangeAt(0),i=r.toString();i=i&&i.trim();var s=a.renderer.currentChapter.cfiBase,c=(new window.EPUBJS.EpubCFI).generateCfiFromRange(l,s),u=a.renderer.currentChapter.spinePos,d=this.props.epubTitle.id,p=window.rangy.getSelection(n).saveCharacterRanges(o.body)[0],h=JSON.stringify(p);return new Ae(d,u,i,c,h,e,"")}},{key:"closeMenu",value:function(){this.props.closeMenu()}},{key:"handleHighlight",value:function(e){var t=document.getElementsByTagName("iframe")[0].contentDocument,a=parseInt(e.target.dataset.color);if(!isNaN(a)){var n=this.createNote(a);this.props.setKey(n.key),this.props.pen.highlightSelection(["color-0","color-1","color-2","color-3"][a]),t.getSelection().empty(),this.props.addNote(n),this.closeMenu(),e.stopPropagation(),console.log("%c Add note here. ","background-color: green")}}},{key:"handleCopyPlainText",value:function(){document.getElementsByTagName("iframe")[0].contentDocument.execCommand("copy",!1,null)?console.log("copied!"):console.log("failed to copy text to clipboard"),this.closeMenu()}},{key:"render",value:function(){var e=this.props,t=e.open,a=e.theme,n=e.posX,o=e.posY,l=e.colors,i=e.classes,s={left:n,top:o,visibility:t?"visible":"hidden",backgroundColor:a?"#424242":"f5f5f5"},c={borderTopColor:a?"#424242":"#f5f5f5"},u={width:20,height:20,color:a?"#fff":"#000"};return r.a.createElement("div",{id:"editor-toolbar",className:i.root,style:s},r.a.createElement("div",{className:i.button,onClick:this.handleHighlight},r.a.createElement("span",{className:i.dot,"data-color":"0",style:{backgroundColor:l[0]}})),r.a.createElement("div",{className:i.button,onClick:this.handleHighlight},r.a.createElement("span",{className:i.dot,"data-color":"1",style:{backgroundColor:l[1]}})),r.a.createElement("div",{className:i.button,onClick:this.handleHighlight},r.a.createElement("span",{className:i.dot,"data-color":"2",style:{backgroundColor:l[2]}})),r.a.createElement("div",{className:i.button,onClick:this.handleHighlight},r.a.createElement("span",{className:i.dot,"data-color":"3",style:{backgroundColor:l[3]}})),r.a.createElement("div",{className:i.button,onClick:this.handleCopyPlainText},r.a.createElement(De.a,{className:i.icon,style:u})),r.a.createElement("div",{className:i.bottom,style:c}))}}]),t}(r.a.Component),qe=Object(ye.withStyles)(function(e){return{root:{position:"absolute",display:"flex",alignItems:"center",height:40,padding:"0 10px",borderRadius:20},button:{cursor:"pointer",padding:"0 8px"},dot:{display:"inline-block",width:20,height:20,borderRadius:"50%",transition:"transform .3s","&:hover":{transform:"scale(1.2)"}},icon:{"&:active":{color:Fe.orange[400]}},bottom:{position:"absolute",width:0,height:0,borderWidth:10,borderStyle:"solid",borderColor:"transparent",left:"50%",marginLeft:"-10px",bottom:"-20px"}}})(ze),He=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={note:a.props.note.note},a.handleChange=a.handleChange.bind(Object(U.a)(a)),a.handleBlur=a.handleBlur.bind(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({note:e.note.note})}},{key:"handleChange",value:function(e){this.setState({note:e.target.value})}},{key:"handleBlur",value:function(e){var t=this.props.note;t.note=e.target.value,this.props.updateNote(t),console.log("note has been updated.",t)}},{key:"render",value:function(){var e=this.props,t=e.posX,a=e.posY,n=e.open,o=e.theme,l=e.classes,i={left:t,top:a,visibility:n?"visible":"hidden",background:o?"#424242":"#f5f5f5"},s={color:o?"#f5f5f5":"#424242"},c={background:o?"#424242":"#f5f5f5"};return r.a.createElement("div",{id:"note-card",className:l.root,style:i},r.a.createElement("div",{className:l.card},r.a.createElement("textarea",{type:"text",value:this.state.note,className:l.textarea,onChange:this.handleChange,onBlur:this.handleBlur,style:s,placeholder:"There is no note here."})),r.a.createElement("div",{className:l.bottom,style:c}))}}]),t}(r.a.Component),_e=Object(ye.withStyles)(function(e){return{root:{position:"absolute",visibility:"hidden",zIndex:100},card:{width:200,boxShadow:"0 2px 15px rgba(0, 0, 0, .1)",padding:"10px 0"},bottom:{width:14,height:14,transform:"rotate(45deg)",position:"absolute",bottom:-7,left:0,right:0,margin:"auto",zIndex:99},textarea:{fontFamily:"sans-serif",fontSize:12,border:"none",outline:"none",width:"100%",padding:"0 10px",minHeight:60,backgroundColor:"transparent",resize:"none","&::-webkit-input-placeholder":{fontStyle:"italic"},"&::-moz-placeholder":{fontStyle:"italic"}}}})(He),Le=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,null,[{key:"getDefaultConfigObj",value:function(){return{theme:!0,colors:["#FBF1D1","#EFEEB0","#CAEFC9","#76BEE9"],background:"#FFF",fontSize:0,lineHeight:0,letterSpacing:0,wordSpacing:0,column:2,padding:10,gutter:80,disablePopup:!1}}},{key:"get",value:function(){var t=localStorage.getItem("config");return JSON.parse(t)||e.getDefaultConfigObj()}},{key:"set",value:function(t,a){var n=localStorage.getItem("config"),o=JSON.parse(n)||e.getDefaultConfigObj();o[t]=a,localStorage.setItem("config",JSON.stringify(o))}},{key:"resetConfig",value:function(){var t=JSON.stringify(e.getDefaultConfigObj());localStorage.setItem("config",t)}},{key:"getDefaultCss",value:function(){var t=e.get(),a=t.colors,n="::selection{background:#f3a6a68c}::-moz-selection{background:#f3a6a68c}[class*=color-]:hover{cursor:pointer;background-image:linear-gradient(0,rgba(0,0,0,.075),rgba(0,0,0,.075))}.color-0{background-color:".concat(a[0],"}.color-1{background-color:").concat(a[1],"}.color-2{background-color:").concat(a[2],"}.color-3{background-color:").concat(a[3],"}"),o=["a, article, cite, code, div, li, p, pre, span, table {","    font-size: ".concat(t.fontSize+"px"," !important;"),"    line-height: ".concat(t.lineHeight+"px"," !important;"),"    letter-spacing: ".concat(t.letterSpacing+"px"," !important;"),"    word-spacing: ".concat(t.wordSpacing+"px"," !important;"),"}","img {","    max-width: 100% !important;","}","body {","    background-color: transparent !important;","    color: ".concat(t.theme?"#000000de":"#f5f5f5"," !important;"),"}"];return o[1]=t.fontSize?o[1]:"",o[2]=t.lineHeight?o[2]:"",o[3]=t.letterSpacing?o[3]:"",o[4]=t.wordSpacing?o[4]:"",n+o.join("\n")}}]),e}(),Je=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,null,[{key:"getStyle",value:function(e,t){return e.currentStyle?e.currentStyle[t]:getComputedStyle(e)[t]}},{key:"addScript",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,a=t.getElementById("qiu-user-script");if(!a)return(a=t.createElement("script")).id="qiu-user-script",a.type="text/javascript",a.defer=!0,a.text=e,void t.body.appendChild(a);a.text=e}},{key:"addCss",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,a=t.getElementById("qiu-user-style");if(!a)return(a=t.createElement("style")).id="qiu-user-style",a.textContent=e,void t.head.appendChild(a);a.textContent=e}},{key:"addDefaultCss",value:function(){var e=Le.getDefaultCss(),t=document.getElementsByTagName("iframe")[0].contentDocument,a=t.getElementById("qiu-default-style");if(!a)return(a=t.createElement("style")).id="qiu-default-style",a.textContent=e,void t.head.appendChild(a);a.textContent=e}},{key:"getUserStyle",value:function(){var e=localStorage.getItem("style")||"{}";return JSON.parse(e)}},{key:"parseStyle",value:function(e){var t=e.split("/* Qiu Plus Separator */");return{inner:t[0]||"",outer:t[1]||""}}},{key:"getUserScript",value:function(){var e=localStorage.getItem("script")||"{}";return JSON.parse(e)}},{key:"parseScript",value:function(e){var t=e.split("/* Qiu Plus Separator */");return{inner:t[0]||"",outer:t[1]||""}}},{key:"applyCss",value:function(){var t=document,a=document.getElementsByTagName("iframe")[0].contentDocument,n=e.getUserStyle();n.inner&&e.addCss(n.inner,a),n.outer&&e.addCss(n.outer,t)}},{key:"applyScript",value:function(){var t=document,a=document.getElementsByTagName("iframe")[0].contentDocument,n=e.getUserScript();n.inner&&e.addCss(n.inner,a),n.outer&&e.addCss(n.outer,t)}},{key:"resetStyle",value:function(){localStorage.setItem("style",JSON.stringify({inner:" ",outer:" "})),Le.resetConfig(),e.applyCss(),e.addDefaultCss()}},{key:"resetScript",value:function(){localStorage.setItem("script",JSON.stringify({inner:" ",outer:" "})),e.applyScript()}}]),e}(),Ue=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,null,[{key:"recordCfi",value:function(e,t){var a=localStorage.getItem("autoBookmark"),n=JSON.parse(a)||{};n[e]=t,localStorage.setItem("autoBookmark",JSON.stringify(n))}},{key:"getCfi",value:function(e){var t=localStorage.getItem("autoBookmark");return(JSON.parse(t)||{})[e]||null}},{key:"clear",value:function(e){var t=localStorage.getItem("autoBookmark"),a=JSON.parse(t)||{};delete a[e],localStorage.setItem("autoBookmark",JSON.stringify(a))}}]),e}(),We=window.rangy,Ye=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={openMenu:!1,openNoteCard:!1,mPosX:0,mPosY:0,nPosX:0,nPosY:0,note:{}},a.x=0,a.y=0,a.pen=null,a.notes=[],a.key="",a.prev=a.prev.bind(Object(U.a)(a)),a.next=a.next.bind(Object(U.a)(a)),a.closeMenu=a.closeMenu.bind(Object(U.a)(a)),a.openMenu=a.openMenu.bind(Object(U.a)(a)),a.closeNoteCard=a.closeNoteCard.bind(Object(U.a)(a)),a.openNoteCard=a.openNoteCard.bind(Object(U.a)(a)),a.renderNotes=a.renderNotes.bind(Object(U.a)(a)),a.getPen=a.getPen.bind(Object(U.a)(a)),a.setNote=a.setNote.bind(Object(U.a)(a)),a.setKey=a.setKey.bind(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){document.removeEventListener("copy",this.copyTextHack)}},{key:"componentDidMount",value:function(){var e=document.getElementById("page-area"),t=this.props,a=t.book,n=t.epub;n.renderTo(e),this.bindEvent(),n.gotoCfi(Ue.getCfi(a.key)),this.copyTextHack=function(e){var t=document.getElementsByTagName("iframe")[0].contentDocument.getSelection().toString()||document.getSelection().toString();e.clipboardData.setData("text/plain",t),e.preventDefault()},document.addEventListener("copy",this.copyTextHack)}},{key:"bindEvent",value:function(){var e=this,t=this.props.epub,a=-1!==navigator.userAgent.indexOf("Firefox"),n=!1,o=function(e){if(e.preventDefault(),!n)return 37===e.keyCode||38===e.keyCode?(t.prevPage(),n=!0,setTimeout(function(){n=!1},100),!1):39===e.keyCode||40===e.keyCode?(t.nextPage(),n=!0,setTimeout(function(){n=!1},100),!1):void 0},r=function(e){if(e.preventDefault(),!n)return e.detail<0?(t.prevPage(),n=!0,setTimeout(function(){n=!1},100),!1):e.detail>0?(t.nextPage(),n=!0,setTimeout(function(){n=!1},100),!1):void 0},l=function(e){if(e.preventDefault(),!n)return e.wheelDelta>0?(t.prevPage(),n=!0,setTimeout(function(){n=!1},100),!1):e.wheelDelta<0?(t.nextPage(),n=!0,setTimeout(function(){n=!1},100),!1):void 0},i=function(e){67===(e.keyCode||e.which)&&e.ctrlKey&&(document.getElementsByTagName("iframe")[0].contentDocument.execCommand("copy",!1,null)?console.log("copied!"):console.log("failed to copy text to clipboard"))};t.on("renderer:chapterDisplayed",function(){e.getPen(),console.log("%c renderer:chapterDisplayed has been triggered! ","color: cyan; background: #333333");var n=t.renderer.doc;n.addEventListener("click",e.openMenu),n.addEventListener("keydown",o,!1),n.addEventListener("keydown",i),a?n.addEventListener("DOMMouseScroll",r,!1):n.addEventListener("mousewheel",l,!1),Je.addDefaultCss(),Je.applyCss(),e.renderNotes()}),t.on("renderer:visibleRangeChanged",function(){var t=e.props,a=t.book,n=t.epub,o=a.key,r=n.getCurrentLocationCfi();Ue.recordCfi(o,r),console.log("auto bookmark: ",r)})}},{key:"closeMenu",value:function(){this.setState({openMenu:!1})}},{key:"openMenu",value:function(e){var t=document.getElementsByTagName("iframe")[0].contentDocument.getSelection();if(this.state.openNoteCard&&this.setState({openNoteCard:!1}),t.isCollapsed)this.state.openMenu&&this.closeMenu();else if(!this.props.disablePopup){var a=this.props.epub.renderer.rangePosition(t.getRangeAt(0));console.log(a);var n=document.getElementById("editor-toolbar"),o=e.clientX,r=e.clientY,l=parseInt(Je.getStyle(n,"width")),i=parseInt(Je.getStyle(n,"height")),s=a.x+a.width/2+l/2,c=a.y-i;s=s<0?0:s,c=c<0?0:c;var u=[o,r];this.x=u[0],this.y=u[1],this.setState({openMenu:!0,mPosX:s,mPosY:c})}}},{key:"closeNoteCard",value:function(){this.setState({openNoteCard:!1})}},{key:"openNoteCard",value:function(e,t){var a=document.getElementById("note-card"),n=parseInt(Je.getStyle(a,"width")),o=parseInt(Je.getStyle(a,"height"));console.log(n,o);var r=e-n/2,l=t-o-20;r=r<0?0:r,l=l<0?0:l,this.setState({openNoteCard:!0,nPosX:r,nPosY:l})}},{key:"setNote",value:function(e){this.setState({note:e})}},{key:"setKey",value:function(e){this.key=e}},{key:"getPen",value:function(){var e=this,t=document.getElementsByTagName("iframe")[0].contentDocument;this.pen=We.createHighlighter(t);["color-0","color-1","color-2","color-3"].forEach(function(t){var a={ignoreWhiteSpace:!0,elementTagName:"span",elementProperties:{onclick:function(t){if(document.getElementsByTagName("iframe")[0].contentDocument.getSelection().isCollapsed){var a=e.props,n=a.gutter,o=a.padding,r=t.currentTarget.dataset.key,l=e.props.getNote(r);l||console.log("no note with key: "+r),e.setNote(l);var i=t.clientX+n,s=t.clientY+o;e.openNoteCard(i,s),t.stopPropagation(),e.state.openMenu&&e.setState({openMenu:!1})}}},onElementCreate:function(t){t.dataset.key=e.key}},n=We.createClassApplier(t,a);e.pen.addClassApplier(n)})}},{key:"renderNotes",value:function(){var e=this;console.log("%c renderNotes has been called! ","color: cyan; background: #333333");var t=this.props,a=t.epub,n=t.getNotesByChapter,o=a.renderer.currentChapter;if(o){this.notes=n(o.spinePos);var r=this.notes,l=document.getElementsByTagName("iframe")[0],i=l.contentWindow||l.contentDocument.defaultView,s=We.getSelection(l),c=We.serializeSelection(s,!0);this.pen&&this.pen.removeAllHighlights();var u=["color-0","color-1","color-2","color-3"];r.forEach(function(t){e.key=t.key;try{var a=JSON.parse(t.range);a=[a],We.getSelection(l).restoreCharacterRanges(l.contentDocument,a)}catch(n){return void console.warn("Exception has been caught when restore character ranges.")}e.pen.highlightSelection(u[t.color])}),i.getSelection().empty(),this.state.openMenu&&We.deserializeSelection(c,null,i)}}},{key:"prev",value:function(){this.props.epub.prevPage(),this.closeMenu(),this.closeNoteCard()}},{key:"next",value:function(){this.props.epub.nextPage(),this.closeMenu(),this.closeNoteCard()}},{key:"render",value:function(){var e=this.props,t=e.epub,a=e.book,n=e.theme,o=e.colors,l=e.column,i=e.gutter,s=e.padding,c=e.addNote,u=e.updateNote,d=e.deleteNote,p=e.classes,h={left:i,right:i,top:s,bottom:s};return t.renderer.forceSingle(1===l),console.log("%c render view-area. ","color: orange; background: #333333"),this.renderNotes(),r.a.createElement("div",{id:"view-area"},r.a.createElement("div",{id:"page-area",className:p.pageArea,style:h}),r.a.createElement("div",{id:"prev",onClick:this.prev,className:p.prev},r.a.createElement(Ce.a,{className:p.button},r.a.createElement(Pe.a,{className:p.arrow}))),r.a.createElement("div",{id:"next",onClick:this.next,className:p.next},r.a.createElement(Ce.a,{className:p.button},r.a.createElement(Ie.a,{className:p.arrow}))),r.a.createElement(qe,{open:this.state.openMenu,posX:this.state.mPosX,posY:this.state.mPosY,closeMenu:this.closeMenu,openNoteCard:this.openNoteCard,addNote:c,setKey:this.setKey,book:a,epub:t,theme:n,colors:o,pen:this.pen,epubTitle:this.props.epubTitle}),r.a.createElement(_e,{open:this.state.openNoteCard,posX:this.state.nPosX,posY:this.state.nPosY,note:this.state.note,theme:n,deleteNote:d,updateNote:u,closeNoteCard:this.closeNoteCard}))}}]),t}(r.a.Component),Xe=Object(ye.withStyles)({pageArea:{position:"absolute",height:600,left:80,right:80,top:0,bottom:0},button:{width:70,height:70,padding:0},arrow:{width:50,height:50},prev:{position:"fixed",left:0,bottom:0,height:"100%",opacity:0,cursor:"pointer",transition:".3s","&:hover":{opacity:1},display:"flex",justifyContent:"center",alignItems:"center"},next:{position:"fixed",right:0,bottom:0,height:"100%",opacity:0,cursor:"pointer",transition:".3s","&:hover":{opacity:1},display:"flex",justifyContent:"center",alignItems:"center"}})(Ye),Ge=a(365),Ve=a.n(Ge),Ke=a(366),Qe=a.n(Ke),$e=a(367),Ze=a.n($e),et=a(368),tt=a.n(et),at=a(370),nt=a.n(at),ot=a(371),rt=a.n(ot),lt=a(372),it=a.n(lt),st=a(369),ct=a.n(st),ut=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={x:a.props.left?a.props.left:0,y:a.props.top?a.props.top:0},a.startX=0,a.startY=0,a.sourceX=0,a.sourceY=0,a.element=null,a.start=a.start.bind(Object(U.a)(a)),a.move=a.move.bind(Object(U.a)(a)),a.end=a.end.bind(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"start",value:function(e){var t=[this.state.x,this.state.y];this.sourceX=t[0],this.sourceY=t[1];var a=[e.clientX,e.clientY];this.startX=a[0],this.startY=a[1],document.addEventListener("mousemove",this.move,!1),document.addEventListener("mouseup",this.end,!1)}},{key:"move",value:function(e){var t=[e.clientX,e.clientY],a=t[1],n=t[0]-this.startX,o=a-this.startY,r=parseInt(this.sourceX+n),l=parseInt(this.sourceY+o),i=window.innerWidth-parseFloat(this.getStyle("width")),s=window.innerHeight-parseFloat(this.getStyle("height"));r=(r=r>i?i:r)<0?0:r,l=(l=l>s?s:l)<0?0:l,this.setState({x:r,y:l})}},{key:"end",value:function(){document.removeEventListener("mousemove",this.move),document.removeEventListener("mouseup",this.end)}},{key:"getStyle",value:function(e){return document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(this.element,null)[e]:this.element.currentStyle[e]}},{key:"render",value:function(){var e=this,t={position:"fixed",left:this.state.x,top:this.state.y};return r.a.createElement("div",{style:t,onMouseDown:this.start,ref:function(t){e.element=t}},this.props.children)}}]),t}(r.a.Component),dt=function e(t,a,n){Object(s.a)(this,e),this.key=(new Date).getTime()+"",this.bookKey=t,this.cfi=a,this.label=n},pt=(a(688),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={isFullScreen:!1,show:!1},a.handleFullScreen=a.handleFullScreen.bind(Object(U.a)(a)),a.handleExitFullScreen=a.handleExitFullScreen.bind(Object(U.a)(a)),a.handleScreen=a.handleScreen.bind(Object(U.a)(a)),a.handleSettings=a.handleSettings.bind(Object(U.a)(a)),a.handleNotes=a.handleNotes.bind(Object(U.a)(a)),a.handleBookmarks=a.handleBookmarks.bind(Object(U.a)(a)),a.handleAddBookmark=a.handleAddBookmark.bind(Object(U.a)(a)),a.handleExit=a.handleExit.bind(Object(U.a)(a)),a.show=a.show.bind(Object(U.a)(a)),a.hide=a.hide.bind(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleFullScreen",value:function(){var e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),this.setState({isFullScreen:!0})}},{key:"handleExitFullScreen",value:function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),this.setState({isFullScreen:!1})}},{key:"handleScreen",value:function(){this.state.isFullScreen?this.handleExitFullScreen():this.handleFullScreen()}},{key:"handleSettings",value:function(){this.props.toggleSettingsDialog(!0)}},{key:"handleNotes",value:function(){this.props.toggleNotes(!0)}},{key:"handleBookmarks",value:function(){this.props.toggleBookmarks(!0)}},{key:"handleAddBookmark",value:function(){var e=this.props.epubTitle.id,t=this.props.epub,a=t.getCurrentLocationCfi(),n=t.renderer.findFirstVisible().textContent;n=n&&n.trim();var o=new dt(e,a,n=n||a);this.props.handleAddBookmark(o),this.props.toggleMessage(!0)}},{key:"handleExit",value:function(){this.props.handleReading(!1)}},{key:"show",value:function(){this.setState({show:!0})}},{key:"hide",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e={display:this.state.isFullScreen?"none":"inline-block"},t={display:this.state.isFullScreen?"inline-block":"none"},a={opacity:this.state.show?"1":".3"},n=window.innerWidth-300-20,o=window.innerHeight-40-40;return r.a.createElement(ut,{left:n,top:o},r.a.createElement("div",{id:"toolbar",className:"toolbar drag-me",onMouseOver:this.show,onMouseOut:this.hide,style:a},r.a.createElement("button",{className:"toolbar-btn drag-me"},r.a.createElement(Ve.a,null)),r.a.createElement("button",{className:"toolbar-btn",onClick:this.handleScreen},r.a.createElement("span",{style:e},r.a.createElement(Qe.a,null)),r.a.createElement("span",{style:t},r.a.createElement(Ze.a,null))),r.a.createElement("button",{className:"toolbar-btn",title:"settings",onClick:this.handleSettings},r.a.createElement(tt.a,null)),r.a.createElement("button",{className:"toolbar-btn",title:"notes",onClick:this.handleNotes},r.a.createElement(ct.a,null)),r.a.createElement("button",{className:"toolbar-btn",title:"bookmark list",onClick:this.handleBookmarks},r.a.createElement(nt.a,null)),r.a.createElement("button",{className:"toolbar-btn",title:"add bookmark",onClick:this.handleAddBookmark},r.a.createElement(rt.a,null)),r.a.createElement("button",{className:"toolbar-btn",title:"exit",onClick:this.handleExit},r.a.createElement(it.a,null))))}}]),t}(r.a.Component)),ht=a(79),mt=a.n(ht),gt=a(65),bt=a.n(gt),ft=a(107),vt=a.n(ft),yt=a(250),kt=a(251),Et=a.n(kt),Ot=a(373),Ct=a.n(Ot),jt=a(374),St=a.n(jt),Nt=a(375),xt=a.n(Nt),wt=a(376),Bt=a.n(wt),Tt=a(108),Pt=a.n(Tt),Mt=function(e){function t(e){var a;Object(s.a)(this,t);var n=(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).props,o=n.colors,r=n.background,l=n.gutter,i=n.padding,c=n.fontSize,p=n.lineHeight,h=n.letterSpacing,m=n.wordSpacing,g=n.column,b=n.disablePopup;return a.state={colors:o,background:r,gutter:l,padding:i,fontSize:c,lineHeight:p,letterSpacing:h,wordSpacing:m,column:g,disablePopup:b},a.handleClose=a.handleClose.bind(Object(U.a)(a)),a.changeTheme=a.changeTheme.bind(Object(U.a)(a)),a.changeColors=a.changeColors.bind(Object(U.a)(a)),a.changeColumn=a.changeColumn.bind(Object(U.a)(a)),a.changeGutter=a.changeGutter.bind(Object(U.a)(a)),a.changePadding=a.changePadding.bind(Object(U.a)(a)),a.changeFontConfig=a.changeFontConfig.bind(Object(U.a)(a)),a.changeUserStyle=a.changeUserStyle.bind(Object(U.a)(a)),a.resetUserStyle=a.resetUserStyle.bind(Object(U.a)(a)),a.disablePopup=a.disablePopup.bind(Object(U.a)(a)),a.handleColorsChange=a.handleColorsChange.bind(Object(U.a)(a)),a.handleOtherChange=a.handleOtherChange.bind(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.colors,a=e.background,n=e.gutter,o=e.padding,r=e.fontSize,l=e.lineHeight,i=e.letterSpacing,s=e.wordSpacing,c=e.column,u=e.disablePopup;this.setState({colors:t,background:a,gutter:n,padding:o,fontSize:r,lineHeight:l,letterSpacing:i,wordSpacing:s,column:c,disablePopup:u})}},{key:"handleClose",value:function(){this.props.toggleSettingsDialog(!1)}},{key:"handleColorsChange",value:function(e){var t=parseInt(e.target.dataset.color),a=this.state.colors;a[t]=e.target.value,this.setState({colors:a})}},{key:"handleOtherChange",value:function(e){var t=e.target.name;this.setState(Object(ve.a)({},t,e.target.value))}},{key:"changeTheme",value:function(e){this.props.toggleTheme(e);var t=Le.getDefaultConfigObj().colors,a=e?t:["#F44336","#F57F17","#8BC34A","#2196F3"];this.props.setConfig("colors",a),Je.addDefaultCss()}},{key:"changeColors",value:function(e){var t=Le.get().colors,a=e.target.value,n=parseInt(e.target.dataset.color);t[n]=a,this.props.setConfig("colors",t),console.log("change highlight color ".concat(n," to ").concat(a)),Je.addDefaultCss()}},{key:"changeColumn",value:function(e,t){t=t?1:2,this.props.setConfig("column",t),console.log("change column to ".concat(t))}},{key:"changeGutter",value:function(e){var t=parseInt(e.target.value);this.props.setConfig("gutter",t),console.log("change gutter to ".concat(t))}},{key:"changePadding",value:function(e){var t=parseInt(e.target.value);this.props.setConfig("padding",t),console.log("change padding to ".concat(t))}},{key:"changeFontConfig",value:function(e){var t,a=e.target.name,n=e.target.value;if("default"===n)t=0;else{if("default"!==n&&isNaN(n))return void alert("Invalid value!");t=parseInt(n)}this.props.setConfig(a,t),console.log("change ".concat(a," to ").concat(t)),Je.addDefaultCss()}},{key:"changeUserStyle",value:function(e){var t=e.target.files[0],a=new FileReader;-1!==t.type.indexOf("text")?(a.readAsText(t),a.onerror=function(){return alert("Error! Please refresh the page and try again.")},a.onload=function(){alert("The stylesheet has been imported.");var e=Je.parseStyle(a.result);console.log(e),localStorage.setItem("style",JSON.stringify(e)),Je.applyCss()}):alert("Invalid stylesheet!")}},{key:"resetUserStyle",value:function(){var e=Le.getDefaultConfigObj();this.props.setConfig("colors",e.colors),this.props.setConfig("padding",e.padding),this.props.setConfig("gutter",e.gutter),this.props.setConfig("fontSize",e.fontSize),this.props.setConfig("lineHeight",e.lineHeight),this.props.setConfig("letterSpacing",e.letterSpacing),this.props.setConfig("wordSpacing",e.wordSpacing),Je.resetStyle()}},{key:"disablePopup",value:function(e,t){this.props.setConfig("disablePopup",t),console.log("disable popup menu: ".concat(t))}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state,n=a.colors,o=(a.background,a.gutter),l=a.padding,i=a.fontSize,s=a.lineHeight,c=a.letterSpacing,u=a.wordSpacing,d=a.column,p=a.disablePopup,h={color0:{backgroundColor:n[0]},color1:{backgroundColor:n[1]},color2:{backgroundColor:n[2]},color3:{backgroundColor:n[3]}};return r.a.createElement("div",{id:"settings"},r.a.createElement(vt.a,{open:this.props.open,onRequestClose:this.handleClose,className:t.root},r.a.createElement(ft.DialogTitle,null,"Settings"),r.a.createElement(ft.DialogContent,null,r.a.createElement("div",{className:t.card,style:h.color0},r.a.createElement("div",null,r.a.createElement(xe.a,{align:"left",type:"subheading"},"theme"),r.a.createElement(bt.a,null)),r.a.createElement("div",{className:t.box},r.a.createElement(Pt.a,{placement:"bottom",title:"light theme"},r.a.createElement(Ct.a,{className:t.icon,onClick:function(){return e.changeTheme(!0)}})),r.a.createElement(Pt.a,{placement:"bottom",title:"dark theme"},r.a.createElement(St.a,{className:t.icon,style:{marginLeft:60},onClick:function(){return e.changeTheme(!1)}})))),r.a.createElement("div",{className:t.card,style:h.color1},r.a.createElement("div",null,r.a.createElement(xe.a,{align:"left",type:"subheading"},"color"),r.a.createElement(bt.a,null)),r.a.createElement("div",null,r.a.createElement("div",{className:t.colorBox,onBlur:this.changeColors,onChange:this.handleColorsChange},r.a.createElement("div",{className:t.colorItem},r.a.createElement("span",{className:t.dot,style:{backgroundColor:n[0]}}),r.a.createElement("input",{className:t.input,"data-color":"0",value:n[0]})),r.a.createElement("div",{className:t.colorItem},r.a.createElement("span",{className:t.dot,style:{backgroundColor:n[1]}}),r.a.createElement("input",{className:t.input,"data-color":"1",value:n[1]})),r.a.createElement("div",{className:t.colorItem},r.a.createElement("span",{className:t.dot,style:{backgroundColor:n[2]}}),r.a.createElement("input",{className:t.input,"data-color":"2",value:n[2]})),r.a.createElement("div",{className:t.colorItem},r.a.createElement("span",{className:t.dot,style:{backgroundColor:n[3]}}),r.a.createElement("input",{className:t.input,"data-color":"3",value:n[3]}))))),r.a.createElement("div",{className:t.card,style:h.color2},r.a.createElement("div",null,r.a.createElement(xe.a,{align:"left",type:"subheading"},"page"),r.a.createElement(bt.a,null)),r.a.createElement("div",null,r.a.createElement("div",{className:t.controlBox},r.a.createElement("span",{className:t.caption},"column"),r.a.createElement("div",null,r.a.createElement(yt.FormControlLabel,{control:r.a.createElement(Et.a,{checked:1===d,onChange:this.changeColumn,classes:{checked:t.checked}}),label:"Use one column",title:"You need to refresh the page."}))),r.a.createElement("div",{className:t.controlBox,onChange:this.handleOtherChange},r.a.createElement("span",{className:t.caption},"gutter"),r.a.createElement("div",null,r.a.createElement("input",{className:t.input,name:"gutter",value:o,onBlur:this.changeGutter}))),r.a.createElement("div",{className:t.controlBox,onChange:this.handleOtherChange},r.a.createElement("span",{className:t.caption},"padding"),r.a.createElement("div",null,r.a.createElement("input",{className:t.input,name:"padding",value:l,onBlur:this.changePadding}))))),r.a.createElement("div",{className:t.card,style:h.color3},r.a.createElement("div",null,r.a.createElement(xe.a,{align:"left",type:"subheading"},"font"),r.a.createElement(bt.a,null)),r.a.createElement("div",{onBlur:this.changeFontConfig,onChange:this.handleOtherChange},r.a.createElement("div",{className:t.controlBox},r.a.createElement("span",{className:t.caption},"font size"),r.a.createElement("div",{title:"Valid range: 10-100"},r.a.createElement("input",{className:t.input,name:"fontSize",value:0===i?"default":i}))),r.a.createElement("div",{className:t.controlBox},r.a.createElement("span",{className:t.caption},"line height"),r.a.createElement("div",{title:"Valid range: 1-100"},r.a.createElement("input",{className:t.input,name:"lineHeight",value:0===s?"default":s}))),r.a.createElement("div",{className:t.controlBox},r.a.createElement("span",{className:t.caption},"letter spacing"),r.a.createElement("div",{title:"Valid range: 0-100"},r.a.createElement("input",{className:t.input,name:"letterSpacing",value:0===c?"default":c}))),r.a.createElement("div",{className:t.controlBox},r.a.createElement("span",{className:t.caption},"word spacing"),r.a.createElement("div",{title:"Valid range: 0-100"},r.a.createElement("input",{className:t.input,name:"wordSpacing",value:0===u?"default":u}))))),r.a.createElement("div",{className:t.card,style:h.color0},r.a.createElement("div",null,r.a.createElement(xe.a,{align:"left",type:"subheading"},"style"),r.a.createElement(bt.a,null)),r.a.createElement("div",{className:t.box},r.a.createElement("label",{htmlFor:"custom-style"},r.a.createElement(Pt.a,{placement:"bottom",title:"import custom stylesheet"},r.a.createElement(xt.a,{className:t.icon})),r.a.createElement("input",{type:"file",accept:"text/css",id:"custom-style",className:t.hide,onChange:this.changeUserStyle})),r.a.createElement(Pt.a,{placement:"bottom",title:"reset"},r.a.createElement(Bt.a,{className:t.icon,onClick:this.resetUserStyle,style:{marginLeft:60}})))),r.a.createElement("div",{className:t.card,style:h.color1},r.a.createElement("div",null,r.a.createElement(xe.a,{align:"left",type:"subheading"},"other"),r.a.createElement(bt.a,null)),r.a.createElement("div",null,r.a.createElement("div",{className:t.controlBox},r.a.createElement("span",{className:t.caption},"popup"),r.a.createElement("div",null,r.a.createElement(yt.FormControlLabel,{control:r.a.createElement(Et.a,{checked:p,onChange:this.disablePopup,classes:{checked:t.checked}}),label:"Disable popup menu"})))))),r.a.createElement(ft.DialogActions,{color:"primary"},r.a.createElement(mt.a,{onClick:this.handleClose},"Close"))))}}]),t}(r.a.Component),It=Object(ye.withStyles)(function(e){return{root:{},card:{minWidth:400,minHeight:60,padding:10,margin:"15px auto",boxShadow:e.shadows[1],transition:"box-shadow .3s","&:hover":{boxShadow:e.shadows[6]}},icon:{color:Fe.grey[700],"&:hover":{color:Fe.orange[700],cursor:"pointer"}},box:{display:"flex",justifyContent:"center",alignItems:"center",padding:"20 0 10"},colorBox:{width:360,padding:"20px 0 10px",margin:"auto",display:"flex",flexWrap:"wrap",justifyContent:"space-around"},colorItem:{width:"45%",margin:"5px 0",display:"flex",alignItems:"center"},dot:{width:14,height:14,display:"inline-block",borderRadius:"50%",border:"1px solid black",marginRight:8},input:{outline:"none",border:"none",width:"80%",borderBottom:"1px dotted black",backgroundColor:"transparent",transition:".3s","&:hover":{borderColor:Fe.orange[700]},"&:focus":{borderColor:Fe.orange[700]}},controlBox:{width:360,display:"flex",alignItems:"center",padding:"5px 10px"},caption:{width:"15%",marginRight:20,fontSize:"small",textAlign:"right",color:Fe.grey[700]},checked:{color:Fe.green[500]},hide:{display:"none"}}})(Mt),Ft=a(184),Rt=a.n(Ft),Dt=a(377),At=a.n(Dt),zt=a(379),qt=a.n(zt),Ht=a(378),_t=a.n(Ht),Lt=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={label:a.props.item.label,editable:!1},a.handleClick=a.handleClick.bind(Object(U.a)(a)),a.handleRemove=a.handleRemove.bind(Object(U.a)(a)),a.handleEdit=a.handleEdit.bind(Object(U.a)(a)),a.handleSave=a.handleSave.bind(Object(U.a)(a)),a.handleChange=a.handleChange.bind(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleClick",value:function(){var e=this.props,t=e.item;e.epub.gotoCfi(t.cfi),this.props.handleClose()}},{key:"handleRemove",value:function(){var e=this.props.item;console.log("remove bookmark with key: ",e.key),this.props.deleteBookmark(e.key)}},{key:"handleEdit",value:function(){this.setState({editable:!0})}},{key:"handleSave",value:function(){var e=this.props.item;e.label=this.state.label,this.props.updateBookmark(e),this.setState({editable:!1})}},{key:"handleChange",value:function(e){this.setState({label:e.target.value})}},{key:"render",value:function(){var e=this.props.classes,t=r.a.createElement(xe.a,{noWrap:!0,className:e.text,onClick:this.handleClick},this.state.label),a=r.a.createElement("input",{type:"text",value:this.state.label,onChange:this.handleChange,className:e.input}),n=r.a.createElement(At.a,{className:e.icon,onClick:this.handleEdit}),o=r.a.createElement(_t.a,{className:e.icon,onClick:this.handleSave}),l=this.state.editable?a:t,i=this.state.editable?o:n;return r.a.createElement("li",{className:e.item},r.a.createElement(Rt.a,{container:!0,align:"center",className:e.container},r.a.createElement(Rt.a,{item:!0,xs:9},r.a.createElement("div",null,l)),r.a.createElement(Rt.a,{item:!0,xs:3},r.a.createElement("div",{className:e.button},i,r.a.createElement(qt.a,{className:e.icon,onClick:this.handleRemove})))))}}]),t}(r.a.Component),Jt=Object(ye.withStyles)(function(e){return{item:{padding:"0 10px",height:40,overflow:"hidden",transition:".3s"},container:{margin:0},text:{"&:hover":{cursor:"pointer",color:Fe.orange[700]}},input:{width:"100%",border:"none",outline:"none",backgroundColor:"transparent",borderBottom:"1px dotted black","&:hover":{borderColor:Fe.orange[700]},"&:focus":{borderColor:Fe.orange[700]}},button:{display:"flex",alignItems:"center",justifyContent:"space-around"},icon:{width:21,height:21,transition:".3s","&:hover":{cursor:"pointer",color:Fe.orange[700]}}}})(Lt),Ut=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={open:!0},a.handleClose=a.handleClose.bind(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleClose",value:function(){this.props.toggleBookmarks(!1)}},{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("div",{id:"bookmarks"},r.a.createElement(Ee.a,{open:this.props.open,onRequestClose:this.handleClose},r.a.createElement("div",{className:t.title},r.a.createElement(xe.a,{type:"headline",align:"center",gutterBottom:!0},"Bookmarks")),r.a.createElement("ul",{className:t.list},this.props.bookmarks.map(function(t){return r.a.createElement(Jt,{key:t.key,item:t,epub:e.props.epub,handleClose:e.handleClose,updateBookmark:e.props.updateBookmark,deleteBookmark:e.props.deleteBookmark})})),r.a.createElement(mt.a,{type:"primary",onClick:this.handleClose},"CLOSE")))}}]),t}(r.a.Component),Wt=Object(ye.withStyles)(function(e){return{title:{marginTop:10},list:{width:280,padding:0,listStyle:"none",overflowX:"hidden"}}})(Ut),Yt=function(){function e(t,a){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(Object(s.a)(this,e),!window.indexedDB)return console.error("Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available."),{};this.dbName=t,this.storeName=a,this.version=o,this.db=null;var r=indexedDB.open(t,o);r.onsuccess=function(e){n.db=e.target.result},r.onerror=function(e){console.error("Something bad happened while trying to open:"+e.target.errorCode)},r.onupgradeneeded=function(e){n.db=e.target.result,n.db.objectStoreNames.contains(a)?console.log("DB version changed, db version: ",n.db.version):n.db.createObjectStore(a,{keyPath:"key"})}}return Object(c.a)(e,[{key:"open",value:function(e,t){var a=this,n=indexedDB.open(this.dbName);n.onsuccess=function(t){return console.log("open database ".concat(a.dbName," successfully")),a.db=t.target.result,e?e():""},n.onerror=function(){return console.error("Can't open database ".concat(a.dbName)),t?t():""}}},{key:"add",value:function(e,t,a){var n=this,o=this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName).add(e);o.onsuccess=function(e){return t?t(e.target.result):""},o.onerror=function(){return console.error("Can't add data to database ".concat(n.dbName," -> ").concat(n.storeName)),a?a():""}}},{key:"remove",value:function(e,t,a){var n=this,o=this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName).delete(e);o.onsuccess=function(a){return console.log("remove data with key ".concat(e," from database ").concat(n.dbName," -> ").concat(n.storeName," successfully")),t?t(a.target.result):""},o.onerror=function(){return console.error("Can't remove data with key ".concat(e," from database ").concat(n.dbName," -> ").concat(n.storeName)),a?a():""}}},{key:"get",value:function(e,t,a){var n=this,o=this.db.transaction(this.storeName,"readonly").objectStore(this.storeName).get(e);o.onsuccess=function(e){return console.log("get data from database ".concat(n.dbName," -> ").concat(n.storeName," successfully")),t?t(e.target.result):""},o.onerror=function(){return console.error("Can't get data with key ".concat(e," from ").concat(n.dbName," -> ").concat(n.storeName)),a?a():""}}},{key:"getAll",value:function(e,t){var a=this,n=this.db.transaction(this.storeName,"readonly").objectStore(this.storeName).openCursor(),o=[];n.onsuccess=function(t){var n=t.target.result;n?(o.push(n.value),n.continue()):(console.log("get all data from database ".concat(a.dbName," -> ").concat(a.storeName," successfully")),e(o))},n.onerror=function(){return console.error("Can't get data from database ".concat(a.dbName," -> ").concat(a.storeName)),t?t():""}}},{key:"update",value:function(e,t,a){var n=this.db.transaction(this.storeName,"readwrite").objectStore(this.storeName).put(e);n.onsuccess=function(e){return console.log("update data successfully"),t?t(e.target.result):""},n.onerror=function(){return console.error("Can't update data"),a?a():""}}},{key:"close",value:function(){this.db.close()}}]),e}(),Xt=a(381),Gt=a.n(Xt),Vt=a(380),Kt=a.n(Vt),Qt=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={note:a.props.note.note,editable:!1},a.handleJump=a.handleJump.bind(Object(U.a)(a)),a.handleDelete=a.handleDelete.bind(Object(U.a)(a)),a.handleEdit=a.handleEdit.bind(Object(U.a)(a)),a.handleChange=a.handleChange.bind(Object(U.a)(a)),a.handleBlur=a.handleBlur.bind(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleJump",value:function(){this.props.handleJump(this.props.note.cfi)}},{key:"handleDelete",value:function(){this.props.deleteNote(this.props.note.key)}},{key:"handleEdit",value:function(){this.setState({editable:!0})}},{key:"handleChange",value:function(e){this.setState({note:e.target.value})}},{key:"handleBlur",value:function(e){var t=this.props.note;t.note=e.target.value,this.props.updateNote(t),this.setState({editable:!1}),console.log("note has been updated!")}},{key:"render",value:function(){var e=this.props,t=e.note,a=e.colors,n=e.classes,o={backgroundColor:a[t.color]},l=r.a.createElement(xe.a,{noWrap:!0,color:"secondary",onClick:this.handleEdit},this.state.note),i=r.a.createElement("input",{type:"text",autoFocus:"autofocus",value:this.state.note,className:n.input,onChange:this.handleChange,onBlur:this.handleBlur});return r.a.createElement("li",null,r.a.createElement("div",{style:o,className:n.item},r.a.createElement("div",{className:n.noteContent},r.a.createElement("div",null,r.a.createElement(xe.a,{noWrap:!0,type:"body2"},t.text)),r.a.createElement("div",null,this.state.editable?i:l)),r.a.createElement("div",null,r.a.createElement(Kt.a,{className:n.icon,onClick:this.handleDelete}),r.a.createElement(Gt.a,{className:n.icon,onClick:this.handleJump,style:{marginTop:15}}))))}}]),t}(r.a.Component),$t=Object(ye.withStyles)(function(e){return{item:{width:"90%",height:80,padding:10,margin:"15px auto",borderRadius:5,display:"flex",alignItems:"center",boxShadow:e.shadows[1],transition:".3s","&:hover":{boxShadow:e.shadows[6]}},noteContent:{width:"70%",flexGrow:"1"},input:{border:"none",outline:"none",color:Fe.grey[600],width:"100%",backgroundColor:"transparent",borderBottom:"1px dotted black"},icon:{width:18,height:18,color:Fe.grey[700],display:"block",transition:".3s","&:hover":{cursor:"pointer",color:Fe.orange[700]}}}})(Qt),Zt=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleClose=a.handleClose.bind(Object(U.a)(a)),a.handleJump=a.handleJump.bind(Object(U.a)(a)),a.handleExport=a.handleExport.bind(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleClose",value:function(){this.props.toggleNotes(!1)}},{key:"handleJump",value:function(e){this.props.epub.gotoCfi(e)}},{key:"handleExport",value:function(){this.props.toggleExport(!0)}},{key:"render",value:function(){var e=this,t=this.props,a=t.notes,n=t.colors,o=t.classes;return r.a.createElement("div",{id:"notes"},r.a.createElement(Ee.a,{open:this.props.open,onRequestClose:this.handleClose,onClick:this.handleClose,anchor:"right",className:o.root},r.a.createElement("div",{className:o.title},r.a.createElement(xe.a,{type:"headline",align:"center",gutterBottom:!0},"Notes")),r.a.createElement("ul",{className:o.list},a.map(function(t){return r.a.createElement($t,{key:t.key,note:t,colors:n,deleteNote:e.props.deleteNote,updateNote:e.props.updateNote,handleJump:e.handleJump})})),r.a.createElement(bt.a,null),r.a.createElement("div",{className:o.foot},r.a.createElement(mt.a,{onClick:this.handleExport,color:"accent",dense:!0},"export"))))}}]),t}(r.a.Component),ea=Object(ye.withStyles)(function(e){return{root:{display:"flex",flexDirection:"column"},title:{marginTop:10},list:{width:280,padding:0,listStyle:"none",flexGrow:2,overflowX:"hidden"},foot:{display:"flex",flexShrink:0,justifyContent:"flex-end",alignItems:"center",width:"100%",height:40,padding:"0 10px"}}})(Zt),ta=a(382),aa=a.n(ta),na=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleClose=a.handleClose.bind(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleClose",value:function(){this.props.toggleMessage(!1)}},{key:"render",value:function(){var e=this.props.open;return r.a.createElement(aa.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:e,autoHideDuration:4e3,onRequestClose:this.handleClose,SnackbarContentProps:{"aria-describedby":"message"},message:r.a.createElement("span",{id:"message"},"Add bookmark successfully."),action:[r.a.createElement(mt.a,{key:"dismiss",color:"accent",dense:!0,onClick:this.handleClose},"DISMISS")]})}}]),t}(r.a.Component),oa=a(383),ra=a.n(oa),la=a(174),ia=a.n(la);function sa(e){return r.a.createElement(ia.a,Object.assign({direction:"up"},e))}var ca,ua=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).copyHandler=function(e){var t=a.generateArticle(!0);e.clipboardData.setData("text/plain",t),e.preventDefault(),console.log("notes copied!"),alert("Notes has been copied.")},a.handleClose=a.handleClose.bind(Object(U.a)(a)),a.generateArticle=a.generateArticle.bind(Object(U.a)(a)),a.handleCopy=a.handleCopy.bind(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleClose",value:function(){this.props.toggleExport(!1)}},{key:"generateArticle",value:function(e){var t=this.props.notes,a="",n=e?"\n*** *** ***\n\n":"\n* * * * * *\n\n";return t.forEach(function(t){var o=e?"":"> ";o+=t.text,o+="\n\n",o+=t.note?"".concat(t.note,"\n"):"",a+=o+=n}),a}},{key:"handleCopy",value:function(){var e=this;document.addEventListener("copy",this.copyHandler),document.execCommand("copy",!1,null),setTimeout(function(){document.removeEventListener("copy",e.copyHandler)},1e3)}},{key:"render",value:function(){var e=this.props,t=e.open,a=e.notes,n=e.book,o=e.classes;return r.a.createElement("div",{id:"export-panel"},r.a.createElement(vt.a,{fullScreen:!0,open:t,onRequestClose:this.handleClose,transition:sa},r.a.createElement("div",{className:o.head},r.a.createElement("div",{className:o.logo},"Notes Preview"),r.a.createElement("div",{className:o.headRight},r.a.createElement(Pt.a,{title:"copy",placement:"bottom"},r.a.createElement(Ce.a,{onClick:this.handleCopy},r.a.createElement(De.a,{className:o.icon}))),r.a.createElement(Ce.a,{onClick:this.handleClose},r.a.createElement(ra.a,null)))),r.a.createElement("div",{className:o.article},r.a.createElement("div",{className:o.page},r.a.createElement("h1",{className:o.title},n.name),a.map(function(e){return r.a.createElement("div",{key:e.key},r.a.createElement("div",{className:o.note},r.a.createElement("blockquote",{className:o.quote},e.text),r.a.createElement("p",{className:o.annotation},e.note)),r.a.createElement(bt.a,null))})))))}}]),t}(r.a.Component),da=Object(ye.withStyles)(function(e){return{head:{width:"100%",height:60,padding:"0 30px",top:0,position:"fixed",display:"flex",justifyContent:"space-between",alignItems:"center",borderBottomWidth:1,borderBottomStyle:"solid",borderColor:e.palette.text.divider,backgroundColor:e.palette.background.paper},logo:{fontFamily:"'Titillium Web', sans-serif",fontSize:"1.5rem",color:e.palette.text.primary},headRight:{display:"flex"},icon:{width:20,height:20},article:{overflowY:"auto",width:"100vw",height:"100vh",marginTop:60},page:{width:660,margin:"50px auto 0",fontFamily:"'Helvetica Neue', 'Arial', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif",color:e.palette.text.primary},title:{fontFamily:"Georgia, Palatino, serif",fontSize:"24px",fontWeight:400,lineHeight:"30px",textAlign:"center",paddingBottom:10},note:{margin:"20px 0"},quote:{borderColor:Fe.orange[400],borderLeft:"6px solid",backgroundColor:Fe.grey[200],borderRadius:"5px",padding:"15px 10px",color:"rgba(0, 0, 0, 0.87)"},annotation:{marginTop:"20px",fontSize:"14px",paddingLeft:"16px"}}})(ua),pa=window.ePub,ha=window.rangy,ma=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={openSettings:!1,openBookmarks:!1,openNotes:!1,openMessage:!1,openExport:!1,bookmarks:[],notes:[],colors:Le.get().colors,background:Le.get().background,gutter:Le.get().gutter,padding:Le.get().padding,fontSize:Le.get().fontSize,lineHeight:Le.get().lineHeight,letterSpacing:Le.get().letterSpacing,wordSpacing:Le.get().wordSpacing,column:Le.get().column,disablePopup:Le.get().disablePopup},a.epub=null,a.toggleSettingsDialog=a.toggleSettingsDialog.bind(Object(U.a)(a)),a.toggleBookmarks=a.toggleBookmarks.bind(Object(U.a)(a)),a.toggleNotes=a.toggleNotes.bind(Object(U.a)(a)),a.toggleMessage=a.toggleMessage.bind(Object(U.a)(a)),a.toggleExport=a.toggleExport.bind(Object(U.a)(a)),a.addBookmark=a.addBookmark.bind(Object(U.a)(a)),a.deleteBookmark=a.deleteBookmark.bind(Object(U.a)(a)),a.updateBookmark=a.updateBookmark.bind(Object(U.a)(a)),a.addNote=a.addNote.bind(Object(U.a)(a)),a.deleteNote=a.deleteNote.bind(Object(U.a)(a)),a.updateNote=a.updateNote.bind(Object(U.a)(a)),a.getNote=a.getNote.bind(Object(U.a)(a)),a.getNotesByChapter=a.getNotesByChapter.bind(Object(U.a)(a)),a.setConfig=a.setConfig.bind(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=new Yt("bookmarks","bookmark");t.open(function(){t.getAll(function(t){var a;a=t.filter(function(t){return t.bookKey===e.props.epubTitle.id}),e.setState({bookmarks:a})})});var a=new Yt("notes","note");a.open(function(){a.getAll(function(t){var a;a=t.filter(function(t){return t.bookKey===e.props.epubTitle.id}),e.setState({notes:a})})}),this.epub=pa(window.webBase+"api/epub/"+this.props.epubTitle.id+".epub")}},{key:"componentDidMount",value:function(){ha.init()}},{key:"setConfig",value:function(e,t){this.setState(Object(ve.a)({},e,t)),Le.set(e,t)}},{key:"toggleSettingsDialog",value:function(e){this.setState({openSettings:e})}},{key:"toggleBookmarks",value:function(e){this.setState({openBookmarks:e})}},{key:"toggleNotes",value:function(e){this.setState({openNotes:e})}},{key:"toggleMessage",value:function(e){this.setState({openMessage:e})}},{key:"toggleExport",value:function(e){this.setState({openExport:e})}},{key:"addBookmark",value:function(e){var t=this,a=new Yt("bookmarks","bookmark");a.open(function(){a.add(e);var n=t.state.bookmarks;n.push(e),t.setState({bookmarks:n})})}},{key:"deleteBookmark",value:function(e){var t=this,a=new Yt("bookmarks","bookmark");a.open(function(){a.remove(e);var n=t.state.bookmarks;n=n.filter(function(t){return t.key!==e}),t.setState({bookmarks:n})})}},{key:"updateBookmark",value:function(e){var t=this,a=new Yt("bookmarks","bookmark");a.open(function(){a.update(e);var n=t.state.bookmarks;n.forEach(function(t,a,n){t.key===e.key&&(n[a]=e)}),t.setState({bookmarks:n})})}},{key:"addNote",value:function(e){var t=this,a=new Yt("notes","note");a.open(function(){a.add(e);var n=t.state.notes;n.push(e),t.setState({notes:n})})}},{key:"deleteNote",value:function(e){var t=this,a=new Yt("notes","note");a.open(function(){a.remove(e);var n=t.state.notes;n=n.filter(function(t){return t.key!==e}),t.setState({notes:n})})}},{key:"updateNote",value:function(e){var t=this,a=new Yt("notes","note");a.open(function(){a.update(e);var n=t.state.notes;n.forEach(function(t,a,n){t.key===e.key&&(n[a]=e)}),t.setState({notes:n})})}},{key:"getNote",value:function(e){var t=this.state.notes,a=null;return t.forEach(function(t){t.key===e&&(a=t)}),a}},{key:"getNotesByChapter",value:function(e){return this.state.notes.filter(function(t){return t.chapter===e})}},{key:"render",value:function(){var e=this.epub,t=this.props.readingBook,a=this.state,n=a.openSettings,o=a.openBookmarks,l=a.openNotes,i=a.openMessage,s=a.openExport,c=a.bookmarks,u=a.notes,d=a.colors,p=a.background,h=a.gutter,m=a.padding,g=a.fontSize,b=a.lineHeight,f=a.letterSpacing,v=a.wordSpacing,y=a.column,k=a.disablePopup;return r.a.createElement("div",{id:"viewer"},r.a.createElement(Be,{epub:e,theme:this.props.theme}),r.a.createElement(Xe,{epub:e,book:this.props.readingBook,addNote:this.addNote,getNote:this.getNote,deleteNote:this.deleteNote,updateNote:this.updateNote,getNotesByChapter:this.getNotesByChapter,theme:this.props.theme,background:p,gutter:h,padding:m,colors:d,column:y,disablePopup:k,epubTitle:this.props.epubTitle}),r.a.createElement(pt,{handleReading:this.props.handleReading,toggleMessage:this.toggleMessage,toggleSettingsDialog:this.toggleSettingsDialog,toggleBookmarks:this.toggleBookmarks,toggleNotes:this.toggleNotes,handleAddBookmark:this.addBookmark,readingBook:this.props.readingBook,epub:e,epubTitle:this.props.epubTitle}),r.a.createElement(Wt,{open:o,toggleBookmarks:this.toggleBookmarks,bookmarks:c,deleteBookmark:this.deleteBookmark,updateBookmark:this.updateBookmark,getBookmark:this.getBookmark,epub:e,epubTitle:this.props.epubTitle}),r.a.createElement(ea,{open:l,toggleNotes:this.toggleNotes,toggleExport:this.toggleExport,notes:u,colors:d,deleteNote:this.deleteNote,updateNote:this.updateNote,epub:e}),r.a.createElement(It,{open:n,toggleSettingsDialog:this.toggleSettingsDialog,toggleTheme:this.props.toggleTheme,setConfig:this.setConfig,colors:d,background:p,gutter:h,padding:m,fontSize:g,lineHeight:b,letterSpacing:f,wordSpacing:v,column:y,disablePopup:k}),r.a.createElement(na,{open:i,toggleMessage:this.toggleMessage}),r.a.createElement(da,{open:s,book:t,notes:u,theme:this.props.theme,toggleExport:this.toggleExport}))}}]),t}(r.a.Component),ga=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={isReading:!0,readingBook:{author:"",description:"",key:"",name:"",content:[]},theme:Le.get().theme},a.handleReading=a.handleReading.bind(Object(U.a)(a)),a.handleReadingBook=a.handleReadingBook.bind(Object(U.a)(a)),a.toggleTheme=a.toggleTheme.bind(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleReading",value:function(e){this.setState({isReading:e})}},{key:"handleReadingBook",value:function(e){this.setState({readingBook:e})}},{key:"toggleTheme",value:function(e){this.setState({theme:e}),Le.set("theme",e)}},{key:"render",value:function(){var e,t=this.state,a=t.isReading,n=t.readingBook,o=t.theme,l=Object(ye.createMuiTheme)({palette:{type:o?"light":"dark"}}),i=r.a.createElement(ma,{handleReading:this.handleReading,readingBook:n,toggleTheme:this.toggleTheme,theme:o,epubTitle:this.props.match.params});return a&&o?e=Le.get().background||"#fff":a&&!o?e="#424242":!a&&o?e="#f1f2f3":a||o||(e="#424242"),document.body.style.backgroundColor=e,r.a.createElement(ye.MuiThemeProvider,{theme:l},r.a.createElement("div",{id:"app"},i))}}]),t}(r.a.Component),ba=(a(721),a(256)),fa=le.a.Search,va=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={username:"",password:"",username2:"",password2:"",errors:a.props.errors},a.handleSubmit=a.handleSubmit.bind(Object(U.a)(a)),a.guestSubmit=a.guestSubmit.bind(Object(U.a)(a)),a.handleRegister=a.handleRegister.bind(Object(U.a)(a)),a.toAdmin=a.toAdmin.bind(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=Object.assign({},this.state);this.props.clearErrors(),this.props.processForm(a).then(function(){t.setState({errors:t.props.errors})})}},{key:"handleRegister",value:function(e){var t=this;e.preventDefault();var a={username:this.state.username2,password:this.state.password2};this.props.clearErrors(),this.props.processRegister(a).then(function(){t.setState({errors:t.props.errors})})}},{key:"componentWillReceiveProps",value:function(){this.props.errors.length<1&&this.setState({errors:[]})}},{key:"guestSubmit",value:function(e){e.preventDefault(),this.props.processForm({username:"guest",password:"password"})}},{key:"update",value:function(e){var t=this;return function(a){return t.setState(Object(ve.a)({},e,a.currentTarget.value))}}},{key:"toAdmin",value:function(){this.props.history.push("/admin")}},{key:"guestlogin",value:function(){if(!1===this.props.loggedIn)return r.a.createElement(S.a,{type:"primary",onClick:this.guestSubmit,className:"login-form-button"},"\u4ee5guest\u8eab\u4efd\u767b\u5f55")}},{key:"handleAlert",value:function(){return!1===this.props.loggedIn?r.a.createElement(ba.a,{message:"\u672a\u767b\u5f55",type:"error"}):r.a.createElement(ba.a,{message:"\u5df2\u767b\u5f55",type:"success"})}},{key:"displayLogin",value:function(){var e=this.props.form.getFieldDecorator;if(!1===this.props.loggedIn)return r.a.createElement(re.a,{onSubmit:this.handleSubmit},r.a.createElement(re.a.Item,null,e("username",{rules:[{required:!0,message:"Please input your username!"}]})(r.a.createElement(le.a,{prefix:r.a.createElement(j.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username",onChange:this.update("username"),required:!0}))),r.a.createElement(re.a.Item,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(r.a.createElement(le.a,{prefix:r.a.createElement(j.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password",onChange:this.update("password"),required:!0}))),r.a.createElement(re.a.Item,null,r.a.createElement(S.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"\u767b\u5f55"),r.a.createElement("div",{className:"login-form-button"},this.guestlogin())))}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator;return r.a.createElement("div",{className:"login-form"},r.a.createElement("div",null,this.handleAlert()),r.a.createElement(S.a,{type:"primary",onClick:this.props.logout},"\u767b\u51fa"),this.displayLogin(),r.a.createElement(re.a,{onSubmit:this.handleRegister},r.a.createElement(re.a.Item,null,t("username2",{rules:[{required:!0,message:"Please input your username!"}]})(r.a.createElement(le.a,{prefix:r.a.createElement(j.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username",onChange:this.update("username2"),required:!0}))),r.a.createElement(re.a.Item,null,t("password2",{rules:[{required:!0,message:"Please input your Password!"}]})(r.a.createElement(le.a,{prefix:r.a.createElement(j.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password",onChange:this.update("password2"),required:!0}))),r.a.createElement(re.a.Item,null,r.a.createElement(S.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"\u6ce8\u518c"))),r.a.createElement(fa,{placeholder:"\u8f93\u5165\u7ba1\u7406\u5458\u53e3\u4ee4",enterButton:"\u7ba1\u7406\u5458\u767b\u5f55",onSearch:function(t){"root"===t&&e.toAdmin()}}))}}]),t}(r.a.Component),ya=re.a.create({name:"normal_login"})(va),ka=Object(h.d)(ya),Ea=Object(W.b)(function(e){var t=e.session,a=e.errors;return{loggedIn:Boolean(t.currentUser),errors:a}},function(e){return{processForm:function(t){return e(function(e){return function(t){return fetch(window.webBase+"api/session",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){return t(X(e))},function(e){return t(Y(e))})}}(t))},processRegister:function(t){return e(function(e){return function(t){return fetch(window.webBase+"/api/user",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){return t(X(e))},function(e){return t(Y(e))})}}(t))},clearErrors:function(){return e({type:"CLEAR_ERRORS",errors:t});var t},logout:function(){return e({type:"LOGOUT"})}}})(ka),Oa=(a(723),function(e){function t(e){return Object(s.a)(this,t),Object(u.a)(this,Object(d.a)(t).call(this,e))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.loggedIn&&this.props.history.push("/books")}},{key:"top",value:function(){return r.a.createElement("section",{className:"sign-up-container"},r.a.createElement(Ea,null))}},{key:"render",value:function(){return r.a.createElement("div",{className:"landing-page"},this.top())}}]),t}(r.a.Component)),Ca=Object(h.d)(Oa),ja=(a(807),a(392)),Sa=(a(726),a(254)),Na=(a(728),le.a.Search),xa=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={author:"",title:"",description:"",cover_img_url:""},a.handleSubmit=a.handleSubmit.bind(Object(U.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"handleSubmit",value:function(){var e=Object.assign({},this.state);console.log(e),fetch(window.webBase+"api/upload",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){return console.log(e)},function(e){return console.log(e)})}},{key:"update",value:function(e){var t=this;return function(a){return t.setState(Object(ve.a)({},e,a.currentTarget.value))}}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={name:"epub",action:window.webBase+"api/upload_epub",headers:{authorization:"authorization-text"},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?Sa.a.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&Sa.a.error("".concat(e.file.name," file upload failed."))}};return r.a.createElement("div",{className:"login-form"},r.a.createElement("h1",{className:"logo"},r.a.createElement("strong",null,"\u4e0a\u4f20\u4e66\u7c4d")),r.a.createElement(re.a,{onSubmit:this.handleSubmit},r.a.createElement(re.a.Item,null,e("author")(r.a.createElement(le.a,{type:"author",placeholder:"author",onChange:this.update("author"),required:!0}))),r.a.createElement(re.a.Item,null,e("title")(r.a.createElement(le.a,{type:"title",placeholder:"title",onChange:this.update("title"),required:!0}))),r.a.createElement(re.a.Item,null,e("description")(r.a.createElement(le.a,{type:"description",placeholder:"description",onChange:this.update("description"),required:!0}))),r.a.createElement(re.a.Item,null,e("cover_img_uri")(r.a.createElement(le.a,{type:"cover_img_url",placeholder:"cover_img_url",onChange:this.update("cover_img_url"),required:!0}))),r.a.createElement(re.a.Item,null,r.a.createElement(S.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"\u4e0a\u4f20"))),r.a.createElement(ja.a,t,r.a.createElement(S.a,null,r.a.createElement(j.a,{type:"upload"})," \u4e0a\u4f20epub\u548csvg\u56fe\u7247,\u547d\u540d\u9700\u548ctitle\u4e00\u81f4")),r.a.createElement("h1",{className:"logo"},r.a.createElement("strong",null,"\u5220\u9664\u4e66\u7c4d")),r.a.createElement(Na,{placeholder:"\u8f93\u5165\u5220\u9664\u4e66\u7c4d\u7684title",enterButton:"\u5220\u9664",onSearch:function(e){fetch(window.webBase+"/api/delete_book/"+e)}}))}}]),t}(r.a.Component),wa=re.a.create({name:"upload"})(xa);Object(m.enquireScreen)(function(e){ca=e});var Ba=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={isMobile:ca},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(m.enquireScreen)(function(t){e.setState({isMobile:!!t})})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(k,{dataSource:R,isMobile:this.isMobile}),r.a.createElement(h.a,{exact:!0,path:"/",component:_}),r.a.createElement(h.a,{exact:!0,path:"/page2",component:ae}),r.a.createElement(h.a,{exact:!0,path:"/page2/:id",component:fe}),r.a.createElement(h.a,{exact:!0,path:"/admin",component:wa}),r.a.createElement(h.a,{exact:!0,path:"/page3",component:K}),r.a.createElement(h.a,{exact:!0,path:"/session",component:Ca}),r.a.createElement(h.a,{exact:!0,path:"/page2/reader/:id",component:ga}),r.a.createElement(C,{dataSource:q,isMobile:this.isMobile}))}}]),t}(o.Component),Ta=a(181),Pa=a(387),Ma=function(e){var t=e.store;return r.a.createElement(W.a,{store:t},r.a.createElement(v.a,null,r.a.createElement(Pa.a,{persistor:Object(Ta.b)(t)},r.a.createElement(Ba,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ia=a(61),Fa=a(388),Ra=a(389),Da=a.n(Ra),Aa=Object.freeze({currentUser:null}),za=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Aa,t=arguments.length>1?arguments[1]:void 0;switch(Object.freeze(e),t.type){case"RECEIVE_CURRENT_USER":var a=t.currentUser;return Da()({},Aa,{currentUser:a});case"LOGOUT":return Aa;default:return e}},qa=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RECEIVE_BOOKS":return Object(te.merge)({},null,t.book);case"RECEIVE_ONE_BOOK":return Object(te.merge)({},e,Object(ve.a)({},t.book.id,t.book));default:return e}},Ha=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RECEIVE_ERRORS":return console.log(t),Object(te.merge)({},e,t.errors);case"CLEAR_ERRORS":return[];default:return e}},_a=Object(Ia.combineReducers)({session:za,books:qa,errors:Ha}),La=a(390),Ja=a(391),Ua=a.n(Ja),Wa=[Fa.a],Ya={key:"root",storage:Ua.a},Xa=Object(Ta.a)(Ya,_a);var Ga=Object(Ia.createStore)(Xa,Object(La.composeWithDevTools)(Ia.applyMiddleware.apply(void 0,Wa)));window.webBase="https://www.mooooon333.cn:5000/",i.a.render(r.a.createElement(Ma,{store:Ga}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[397,1,2]]]);
//# sourceMappingURL=main.eb1152dc.chunk.js.map